!function(){var a,b=window,c=!0,d={toString:1},e=Object.prototype,f=e.toString,g=(Object.prototype.hasOwnProperty,/\S/),h=function(){var a=h.caller.caller;return a.$owner.prototype[a.$name].apply(this,arguments)},i=b.Box={};i.global=b;for(a in d)c=!c;return c&&(c=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]),i.enumerables=c,i.apply=function(a,b,d){if(d&&i.apply(a,d||{}),a&&b&&"object"==typeof b){var e,f,g;for(e in b)a[e]=b[e];if(c)for(f=c.length;f--;)g=c[f],b.hasOwnProperty(g)&&(a[g]=b[g])}return a},i.apply(i,{name:"Box",emptyString:"",emptyFn:function(){},EMPTY_STRING:"",EMPTY_FUNCTION:function(){},identityFn:function(a){return a},applyIf:function(a,b){var c;if(a)for(c in b)void 0===a[c]&&(a[c]=b[c]);return a},each:function(a){i.isEmpty(a)||i[i.isIterable(a)?"Array":"Object"].each.apply(this,arguments)},log:function(a,b){var c=i.global.console;c&&(1==arguments.length&&(b=a,a="log"),c[a](b))},Error:function(a){var b,c,d;if(a=a||{},i.isString(a))if((b=this.Error.caller)&&(d=b.__$owner)){var e=b.__$name,f=d.__$namespace;if(e&&f)return i.Error({className:f,methodName:e,error:a})}else a={error:a};throw c=a.className&&a.methodName?"["+a.className+"."+a.methodName+"]: "+a.error:a.error,new Error(c)}}),i.apply(i,{extend:function(){var a=e.constructor,b=function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};return function(c,d,e){i.isObject(d)&&(e=d,d=c,c=e.constructor!==a?e.constructor:function(){d.apply(this,arguments)}),d||i.Error({className:"Box",methodName:"extend",msg:"Attempting to extend from a class which has not been loaded on the page."});var f,g=function(){},h=d.prototype;return g.prototype=h,f=c.prototype=new g,f.constructor=c,c.superclass=h,h.constructor===a&&(h.constructor=d),c.override=function(a){i.override(c,a)},f.override=b,f.proto=f,c.override(e),c.extend=function(a){return i.extend(c,a)},c}}(),override:function(a,b){if(a.$isClass)a.override(b);else if("function"==typeof a)i.apply(a.prototype,b);else{var c,d,e=a.self;if(e&&e.$isClass)for(c in b)b.hasOwnProperty(c)&&(d=b[c],"function"==typeof d&&(e.$className&&(d.displayName=e.$className+"#"+c),d.$name=c,d.$owner=e,d.$previous=a.hasOwnProperty(c)?a[c]:h),a[c]=d);else i.apply(a,b)}return a}}),i.apply(i,{objectPrototype:Object.prototype,isEmptyObject:function(a){if(!a||!i.isObject(a))return!1;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},isEmpty:function(a,b){return null===a||void 0===a||i.isArray(a)&&!a.length||a.jquery&&!a.length||(b?!1:""===a)},isArray:function(a){return"[object Array]"===i.objectPrototype.toString.apply(a)},isObject:function(a){return!!a&&!a.tagName&&"[object Object]"===i.objectPrototype.toString.apply(a)},isFunction:function(a){return"[object Function]"===i.objectPrototype.toString.apply(a)},isString:function(a){return"string"==typeof a},isNumber:function(a){return"[object Number]"===i.objectPrototype.toString.apply(a)},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},isInteger:function(a){return i.isNumeric(a)&&new RegExp(/^\d+$/).test(a)},isDate:function(a){return"[object Date]"===i.objectPrototype.toString.apply(a)},isBoolean:function(a){return"[object Boolean]"===i.objectPrototype.toString.apply(a)},isPrimitive:function(a){return i.isString(a)||i.isNumber(a)||i.isBoolean(a)},isElement:function(a){return"object"==typeof HTMLElement?a instanceof HTMLElement:a&&"object"==typeof a&&1===a.nodeType&&"string"==typeof a.nodeName},isDefined:function(a){return"undefined"!=typeof a},isIterable:function(a){return a?i.isArray(a)||a.callee||a.find&&a.filter?!0:/NodeList|HTMLCollection/.test(i.objectPrototype.toString.apply(a))?!0:("undefined"!=typeof a.nextNode||a.item)&&i.isNumber(a.length)||!1:!1},isEmail:function(a){return a&&null!=a.match(/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/)},isRegExp:function(a){return a&&"[object RegExp]"==i.objectPrototype.toString.call(a)}}),i.apply(i,{typeOf:function(a){var b,c;if(null===a)return"null";if(b=typeof a,"undefined"===b||"string"===b||"number"===b||"boolean"===b)return b;switch(c=f.call(a)){case"[object Array]":return"array";case"[object Date]":return"date";case"[object Boolean]":return"boolean";case"[object Number]":return"number";case"[object RegExp]":return"regexp"}return"function"===b?"function":"object"===b?void 0!==a.nodeType?3===a.nodeType?g.test(a.nodeValue)?"textnode":"whitespace":"element":"object":void i.Error({className:"Box",methodName:"typeOf",error:'Failed to determine the type of the specified value "'+a+'". This is most likely a bug.'})},copyTo:function(a,b,c){"string"==typeof c&&(c=c.split(/[,;\s]/));var d,e,f=c?c.length:0;for(d=0;f>d;d++)e=c[d],b.hasOwnProperty(e)&&(a[e]=b[e]);return a},clone:function(a){if(null===a||void 0===a)return a;if(a.nodeType&&a.cloneNode)return a.cloneNode(!0);var b=f.call(a);if("[object Date]"===b)return new Date(a.getTime());var d,e,g,h,j;if("[object Array]"===b)for(d=a.length,h=[];d--;)h[d]=i.clone(a[d]);else if("[object Object]"===b&&a.constructor===Object){h={};for(j in a)h[j]=i.clone(a[j]);if(c)for(e=c.length;e--;)g=c[e],h[g]=a[g]}return h||a},isEqual:function(a,b){if(a===b)return!0;if(i.isEmpty(a)&&i.isEmpty(b))return!0;var c=i.typeOf(a);if(c!=i.typeOf(b))return!1;switch(c){case"string":return a==String(b);case"number":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"date":case"boolean":return+a==+b;case"regexp":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase;case"array":var d=a.toString(),e=b.toString();return-1===d.indexOf("[object")&&-1===e.indexOf("[object")&&d===e}if("object"!=typeof a||"object"!=typeof b)return!1;if(i.isObject(a)&&i.isObject(b)){if(!i.isEqual(i.Object.getKeys(a),i.Object.getKeys(b)))return!1;for(var f in a)if(a[f]!==b[f])return!1;return!0}},coerce:function(a,b){var c=i.typeOf(a),d=b&&b.name||i.typeOf(b),e="string"==typeof a;if(i.isEmpty(d))return a;if(d=d.toLowerCase(),c!==d)switch(d){case"string":return String(a);case"number":return Number(a);case"boolean":return!e||a&&"false"!==a?Boolean(a):!1;case"null":return!e||a&&"null"!==a?a:null;case"undefined":return!e||a&&"undefined"!==a?a:void 0;case"date":return e&&isNaN(a)?i.Date.parse(a,i.Date.defaultFormat):Date(Number(a))}return a}}),i}();
window.undefined=window.undefined,Box.globalEval=Box.global.execScript?function(a){return execScript(a)}:function($$code){return function(){var Box=this.Box;return eval($$code)}()},Box.isEmpty(Box.DOM_QUERY=window.jQuery||window.$)&&Box.Error("you must load jquery lib"),Box.apply(Box,{USE_NATIVE_JSON:!1,TEMPLATE_TYPE:"tpl",TEMPLATE_SERVER_URL:null,TEMPLATE_SERVER_METHOD:"GET"}),Box.apply(Box.Namespace={},{classes:{},toName:function(a){return a.replace(/\//g,".")},toUrl:function(a){return a.replace(/\./g,"/")},set:function(a,b){this.classes[a]=this.assign(a,b)},get:function(a){if(Box.isEmpty(a))return null;if(!Box.isString(a))return a;if(this.classes.hasOwnProperty(a))return this.classes[a];for(var b,c=Box.global,d=this.parse(a),e=0,f=d.length;f>e;e++)if(b=d[e],Box.isString(b)){if(!c||!c[b])return null;c=c[b]}else c=b;return c},parse:function(a){if(!Box.isString(a))throw new Error("[Box.ClassManager] Invalid namespace, must be a string");var b=[],c=Box.global;return b.push(c),b=b.concat(a.split(/\/|\./g))},assign:function(a,b){var c=Box.global,d=this.parse(a),e=d.pop();return Box.Array.forEach(d,function(a){Box.isString(a)?(c[a]||(c[a]={}),c=c[a]):c=a}),c[e]=b,c[e]},create:function(){var a=Box.global,b=Box.Array.toArray(arguments);return Box.Array.forEach(b,function(b){Box.Array.forEach(Box.Namespace.parse(b),function(b){Box.isString(b)?(a[b]||(a[b]={}),a=a[b]):a=b})},this),a}}),Box.ns=Box.namespace=Box.Namespace.create;
Box.apply(Box.Keyboard={},{BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,RETURN:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123}),Box.apply(Box.StatusType={},{SUCCESS:"success",FAIL:"fail",OK:"ok",YES:"yes",NO:"no",CONFIRE:"confirm",CANCEL:"cancel",INFO:"info",WARNING:"warning",QUESTION:"question",ERROR:"error",NOT_FIND:404,SERVER_ERROR:500,HTTP_OK:200}),Box.apply(Box.ElementTag={},{ABBR:"abbr",ADDRESS:"address",AREA:"area",ARTICLE:"article",AUDIO:"audio",DIV:"div",SPAN:"span",A:"a",UL:"ul",LI:"li",TABLE:"table",TBODY:"tbody",THEAD:"thead",TFOOT:"tfoot",TR:"tr",TD:"td",TH:"th",DL:"dl",DT:"dt",DD:"dd",BODY:"body",HTML:"html",HEAD:"head",LINK:"link",SCRIPT:"script",B:"b",BOTTON:"botton",CANVAS:"canvas",CAPTION:"caption",CENTER:"center",CITE:"cite",CODE:"code",COL:"col",COLGROUP:"colgroup",DEL:"del",DETAILS:"details",DIR:"dir",EM:"em",EMBED:"embed",FONT:"font",FORM:"form",FRAME:"frame",FRAMESET:"frameset",HEADER:"header",HR:"hr",H1:"h1",H2:"h2",H3:"h3",H4:"h4",H5:"h5",H6:"h6",I:"i",IFRAME:"iframe",IMG:"img",INPUT:"input",INS:"ins",LABEL:"label",MAP:"map",MARK:"mark",MENU:"menu",MENUITEM:"menuitem",META:"meta",METER:"meter",NAV:"nav",NOFRAMES:"noframes",NOSCRIPT:"noscript",OBJECT:"object",OL:"ol",OPTION:"option",OUTPUT:"output",P:"p",PARAM:"param",PRE:"pre",PROGRESS:"progress",S:"s",SECTION:"section",SELECT:"select",SMALL:"small",SOURCE:"source",STRONG:"strong",STYLE:"style",SUB:"sub",SUMMARY:"summary",SUP:"sup",TEXTAREA:"textarea",TIME:"time",TITLE:"title",TRACK:"track",TT:"tt",U:"u",VAR:"var",VIDEO:"video",WBR:"wbr"}),Box.apply(Box.EventType={},{CLICK:"click",DBLCLICK:"dblclick",BLUR:"blur",CHANGE:"change",ERROR:"error",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",KEYUP:"keyup",MOUSEDOWN:"mousedown",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEOVER:"mouseover",MOUSEUP:"mouseup",RESIZE:"resize",SCROLL:"scroll",SELECT:"select",SUBMIT:"submit"});
!function(a){function b(a,b){return 0>b?Math.max(0,a.length+b):Math.min(a.length,b)}function c(a,c,d,e){var f,g,h,i,j,k,l=e?e.length:0,m=a.length,n=b(a,c);if(n===m)l&&a.push.apply(a,e);else{if(f=Math.min(d,m-n),g=n+f,h=g+l-f,i=m-g,j=m-f,g>h)for(k=0;i>k;++k)a[h+k]=a[g+k];else if(h>g)for(k=i;k--;)a[h+k]=a[g+k];if(l&&n===j)a.length=j,a.push.apply(a,e);else for(a.length=j+l,k=0;l>k;++k)a[n+k]=e[k]}return a}function d(a,b,c,d){return d&&d.length?b<a.length?a.splice.apply(a,[b,c].concat(d)):a.push.apply(a,d):a.splice(b,c),a}function e(a,b,d){return c(a,b,d)}function f(a,b,c){return a.splice(b,c),a}function g(a,d,e){var f=b(a,d),g=a.slice(d,b(a,f+e));return arguments.length<4?c(a,f,e):c(a,f,e,j.call(arguments,3)),g}function h(a){return a.splice.apply(a,j.call(arguments,1))}var i=Array.prototype,j=i.slice,k=function(){var a,b=[],c=20;if(!b.splice)return!1;for(;c--;)b.push("A");return b.splice(15,0,"F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F"),a=b.length,b.splice(13,0,"XXX"),a+1!=b.length?!1:!0}(),l=k?f:e,m=k?d:c,n=k?h:g,i=Array.prototype,o="forEach"in i,p="map"in i,q="indexOf"in i,r="every"in i,s="some"in i,t="filter"in i,u=function(){var a=[1,2,3,4,5].sort(function(){return 0});return 1===a[0]&&2===a[1]&&3===a[2]&&4===a[3]&&5===a[4]}(),v=!0;try{"undefined"!=typeof document&&j.call(document.getElementsByTagName("body"))}catch(w){v=!1}a.Array={each:function(b,c,d,e){b=a.Array.from(b);var f,g,h=b.length;if(e!==!0){for(f=0;h>f;f++)if(g=b[f],c.call(d||g,g,f,b)===!1)return f}else for(f=h-1;f>-1;f--)if(g=b[f],c.call(d||g,g,f,b)===!1)return f;return!0},forEach:function(b,c,d){if(b=a.Array.from(b),o)return b.forEach(c,d);var e,f,g=b.length;for(e=0;g>e;e++)f=b[e],c.call(d,f,e,b)},indexOf:function(a,b,c){if(c=c||0,q)return a.indexOf(b,c);var d,e=a.length;for(d=0>c?Math.max(0,e+c):c||0;e>d;d++)if(a[d]===b)return d;return-1},contains:function(b,c){return a.Array.indexOf(b,c)>-1},subArray:function(a,b,c){return i.slice.call(a||[],b||0,c||a.length)},slice:function(a,b,c){return this.subArray(a,b,c)},map:function(b,c,d){if(c||a.Error({className:"Box.Array",methodName:"map",error:"fn must be a valid callback function"}),p)return b.map(c,d);for(var e=[],f=0,g=b.length;g>f;f++)e[f]=c.call(d,b[f],f,b);return e},clean:function(b){for(var c,d=[],e=0,f=b.length;f>e;e++)c=b[e],a.isEmpty(c)||d.push(c);return d},filter:function(b,c,d){if(c||a.Error({className:"Box.Array",methodName:"filter",error:"fn must be a valid callback function"}),t)return b.filter(c,d);for(var e=[],f=0,g=b.length;g>f;f++)c.call(d,b[f],f,b)===!0&&e.push(b[f]);return e},unique:function(b){for(var c,d=[],e=0,f=b.length;f>e;e++)c=b[e],-1===a.Array.indexOf(d,c)&&d.push(c);return d},remove:function(b,c){var d=a.Array.indexOf(b,c);return-1!==d&&b.splice(d,1),b},include:function(b,c){return a.Array.contains(b,c)||b.push(c),b},clone:function(a){return i.slice.call(a)},merge:function(){if(0==arguments.length)return[];var b=a.Array,c=arguments[0],d=i.slice.call(arguments,1);return b.each(d,function(a){b.each(a,function(a){c.push(a)})}),c},uniqueMerge:function(){if(0==arguments.length)return[];var b=a.Array,c=b.unique(arguments[0]),d=i.slice.call(arguments,1);return b.each(d,function(a){b.each(a,function(a){b.include(c,a)})}),c},from:function(b,c){return void 0===b||null===b?[]:a.isArray(b)?c?j.call(b):b:b&&void 0!==b.length&&"string"!=typeof b?a.Array.toArray(b):[b]},toArray:function(a,b,c){if(!a||!a.length)return[];if("string"==typeof a&&(a=a.split("")),v)return j.call(a,b||0,c||a.length);var d,e=[];for(b=b||0,c=c?0>c?a.length+c:c:a.length,d=b;c>d;d++)e.push(a[d]);return e},min:function(b,c){a.isIterable(b)||a.Error({className:"Box.Array",methodName:"min",error:"arguments type must be an array"});var d,e,f,g=b[0];for(d=0,e=b.length;e>d;d++)f=b[d],c?1===c(g,f)&&(g=f):g>f&&(g=f);return g},max:function(b,c){a.isIterable(b)||a.Error({className:"Box.Array",methodName:"max",error:"arguments type must be an array"});var d,e,f,g=b[0];for(d=0,e=b.length;e>d;d++)f=b[d],c?-1===c(g,f)&&(g=f):f>g&&(g=f);return g},sum:function(b){a.isIterable(b)||a.Error({className:"Box.Array",methodName:"sum",error:"arguments type must be an array"});var c,d,e,f=0;for(c=0,d=b.length;d>c;c++)e=b[c],f+=e;return f},mean:function(b){return b.length>0?a.Array.sum(b)/b.length:void 0},pluck:function(b,c){var d=[];return a.each(b,function(a){d.push(a[c])}),d},flatten:function(b){function c(b){var e,f,g;for(e=0,f=b.length;f>e;e++)g=b[e],a.isArray(g)?c(g):d.push(g);return d}var d=[];return c(b)},grep:function(a,b,c){var d,e=[];c=!!c;for(var f=0,g=a.length;g>f;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},erase:l,replace:m,splice:n,insert:function(a,b,c){return m(a,b,0,c)},sort:u?function(a,b){return b?a.sort(b):a.sort()}:function(a,b){for(var c,d,e,f,g=a.length,h=0;g>h;h++){for(e=h,d=h+1;g>d;d++)b?(c=b(a[d],a[e]),0>c&&(e=d)):a[d]<a[e]&&(e=d);e!==h&&(f=a[h],a[h]=a[e],a[e]=f)}return a},some:s?function(b,c,d){return c||a.Error({className:"Box.Array",methodName:"some",error:"must have a callback function passed as second argument."}),b.some(c,d)}:function(b,c,d){c||a.Error({className:"Box.Array",methodName:"some",error:"must have a callback function passed as second argument."});for(var e=0,f=b.length;f>e;++e)if(c.call(d,b[e],e,b))return!0;return!1},every:r?function(b,c,d){return c||a.Error({className:"Box.Array",methodName:"every",error:"must have a callback function passed as second argument."}),b.every(c,d)}:function(b,c,d){c||a.Error({className:"Box.Array",methodName:"every",error:"must have a callback function passed as second argument."});for(var e=0,f=b.length;f>e;++e)if(!c.call(d,b[e],e,b))return!1;return!0},difference:function(a,b){var c,d,e,f=j.call(a),g=f.length;for(c=0,e=b.length;e>c;c++)for(d=0;g>d;d++)f[d]===b[c]&&(l(f,d,1),d--,g--);return f},intersect:function(){var b,c,d,e,f,g,h,i,k,m,n,o,p,q=[],r=j.call(arguments);if(!r.length)return q;for(b=r.length,n=f=0;b>n;n++)g=r[n],(!e||g.length<e.length)&&(e=g,f=n);for(e=a.Array.unique(e),l(r,f,1),h=e.length,b=r.length,n=0;h>n;n++){for(i=e[n],m=0,o=0;b>o;o++)for(c=r[o],d=c.length,p=0;d>p;p++)if(k=c[p],i===k){m++;break}m===b&&q.push(i)}return q},invoke:function(a,b){var c,d,e=[],f=Array.prototype.slice.call(arguments,2),g=a.length;for(c=0;g>c;c++)d=a[c],e.push(d&&"function"==typeof d[b]?d[b].apply(d,f):void 0);return e}}}(Box);
Box.Date=new function(){function a(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(g,function(a,c){return b[c]})}var b=this,c=/(\\.)/g,d=/([gGhHisucUOPZ]|MS)/,e=/([djzmnYycU]|MS)/,f=/\\/gi,g=/\{(\d+)\}/g,h=new RegExp("\\/Date\\(([-+])?(\\d+)(?:[+-]\\d{4})?\\)\\/"),i=["var me = this, dt, y, m, d, h, i, s, ms, o, O, z, zz, u, v, W, year, jan4, week1monday,","def = me.defaults,","from = Box.Number.from,","results = String(input).match(me.parseRegexes[{0}]);","if(results){","{1}","if(u != null){","v = new Date(u * 1000);","}else{","dt = me.clearTime(new Date);","y = from(y, from(def.y, dt.getFullYear()));","m = from(m, from(def.m - 1, dt.getMonth()));","d = from(d, from(def.d, dt.getDate()));","h  = from(h, from(def.h, dt.getHours()));","i  = from(i, from(def.i, dt.getMinutes()));","s  = from(s, from(def.s, dt.getSeconds()));","ms = from(ms, from(def.ms, dt.getMilliseconds()));","if(z >= 0 && y >= 0){","v = me.add(new Date(y < 100 ? 100 : y, 0, 1, h, i, s, ms), me.YEAR, y < 100 ? y - 100 : 0);","v = !strict? v : (strict === true && (z <= 364 || (me.isLeapYear(v) && z <= 365))? me.add(v, me.DAY, z) : null);","}else if(strict === true && !me.isValid(y, m + 1, d, h, i, s, ms)){","v = null;","}else{","if (W) {","year = y || (new Date()).getFullYear(),","jan4 = new Date(year, 0, 4, 0, 0, 0),","week1monday = new Date(jan4.getTime() - ((jan4.getDay() - 1) * 86400000));","v = Box.Date.clearTime(new Date(week1monday.getTime() + ((W - 1) * 604800000)));","} else {","v = me.add(new Date(y < 100 ? 100 : y, m, d, h, i, s, ms), me.YEAR, y < 100 ? y - 100 : 0);","}","}","}","}","if(v){","if(zz != null){","v = me.add(v, me.SECOND, -v.getTimezoneOffset() * 60 - zz);","}else if(o){","v = me.add(v, me.MINUTE, -v.getTimezoneOffset() + (sn == '+'? -1 : 1) * (hr * 60 + mn));","}","}","return v;"].join("\n");Box.apply(b,{now:Date.now||function(){return+new Date},toString:function(a){var b=Box.String.leftPad;return a.getFullYear()+"-"+b(a.getMonth()+1,2,"0")+"-"+b(a.getDate(),2,"0")+"T"+b(a.getHours(),2,"0")+":"+b(a.getMinutes(),2,"0")+":"+b(a.getSeconds(),2,"0")},getElapsed:function(a,b){return Math.abs(a-(b||new Date))},useStrict:!1,formatCodeToRegex:function(c,d){var e=b.parseCodes[c];return e&&(e="function"==typeof e?e():e,b.parseCodes[c]=e),e?Box.applyIf({c:e.c?a(e.c,d||"{0}"):e.c},e):{g:0,c:null,s:Box.String.escapeRegex(c)}},parseFunctions:{MS:function(a){var b=(a||"").match(h);return b?new Date(1*((b[1]||"")+b[2])):null},time:function(a){var b=parseInt(a,10);return b||0===b?new Date(b):null},timestamp:function(a){var b=parseInt(a,10);return b||0===b?new Date(1e3*b):null}},parseRegexes:[],formatFunctions:{MS:function(){return"\\/Date("+this.getTime()+")\\/"},time:function(){return this.getTime().toString()},timestamp:function(){return b.format(this,"U")}},y2kYear:50,MILLI:"ms",SECOND:"s",MINUTE:"mi",HOUR:"h",DAY:"d",MONTH:"mo",YEAR:"y",defaults:{},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNumbers:{January:0,Jan:0,February:1,Feb:1,March:2,Mar:2,April:3,Apr:3,May:4,June:5,Jun:5,July:6,Jul:6,August:7,Aug:7,September:8,Sep:8,October:9,Oct:9,November:10,Nov:10,December:11,Dec:11},defaultFormat:"Y-m-d",getShortMonthName:function(a){return Box.Date.monthNames[a].substring(0,3)},getShortDayName:function(a){return Box.Date.dayNames[a].substring(0,3)},getMonthNumber:function(a){return Box.Date.monthNumbers[a.substring(0,1).toUpperCase()+a.substring(1,3).toLowerCase()]},formatContainsHourInfo:function(a){return d.test(a.replace(c,""))},formatContainsDateInfo:function(a){return e.test(a.replace(c,""))},unescapeFormat:function(a){return a.replace(f,"")},formatCodes:{d:"Box.String.leftPad(this.getDate(), 2, '0')",D:"Box.Date.getShortDayName(this.getDay())",j:"this.getDate()",l:"Box.Date.dayNames[this.getDay()]",N:"(this.getDay() ? this.getDay() : 7)",S:"Box.Date.getSuffix(this)",w:"this.getDay()",z:"Box.Date.getDayOfYear(this)",W:"Box.String.leftPad(Box.Date.getWeekOfYear(this), 2, '0')",F:"Box.Date.monthNames[this.getMonth()]",m:"Box.String.leftPad(this.getMonth() + 1, 2, '0')",M:"Box.Date.getShortMonthName(this.getMonth())",n:"(this.getMonth() + 1)",t:"Box.Date.getDaysInMonth(this)",L:"(Box.Date.isLeapYear(this) ? 1 : 0)",o:"(this.getFullYear() + (Box.Date.getWeekOfYear(this) == 1 && this.getMonth() > 0 ? +1 : (Box.Date.getWeekOfYear(this) >= 52 && this.getMonth() < 11 ? -1 : 0)))",Y:"Box.String.leftPad(this.getFullYear(), 4, '0')",y:"('' + this.getFullYear()).substring(2, 4)",a:"(this.getHours() < 12 ? 'am' : 'pm')",A:"(this.getHours() < 12 ? 'AM' : 'PM')",g:"((this.getHours() % 12) ? this.getHours() % 12 : 12)",G:"this.getHours()",h:"Box.String.leftPad((this.getHours() % 12) ? this.getHours() % 12 : 12, 2, '0')",H:"Box.String.leftPad(this.getHours(), 2, '0')",i:"Box.String.leftPad(this.getMinutes(), 2, '0')",s:"Box.String.leftPad(this.getSeconds(), 2, '0')",u:"Box.String.leftPad(this.getMilliseconds(), 3, '0')",O:"Box.Date.getGMTOffset(this)",P:"Box.Date.getGMTOffset(this, true)",T:"Box.Date.getTimezone(this)",Z:"(this.getTimezoneOffset() * -60)",c:function(){var a,c,d,e,f;for(a="Y-m-dTH:i:sP",c=[],d=0,e=a.length;e>d;++d)f=a.charAt(d),c.push("T"==f?"'T'":b.getFormatCode(f));return c.join(" + ")},U:"Math.round(this.getTime() / 1000)"},isValid:function(a,c,d,e,f,g,h){e=e||0,f=f||0,g=g||0,h=h||0;var i=b.add(new Date(100>a?100:a,c-1,d,e,f,g,h),b.YEAR,100>a?a-100:0);return a==i.getFullYear()&&c==i.getMonth()+1&&d==i.getDate()&&e==i.getHours()&&f==i.getMinutes()&&g==i.getSeconds()&&h==i.getMilliseconds()},parse:function(a,c,d){var e=b.parseFunctions;return null==e[c]&&b.createParser(c),e[c].call(b,a,Box.isDefined(d)?d:b.useStrict)},parseDate:function(a,c,d){return b.parse(a,c,d)},getFormatCode:function(a){var c=b.formatCodes[a];return c&&(c="function"==typeof c?c():c,b.formatCodes[a]=c),c||"'"+Box.String.escape(a)+"'"},createFormat:function(a){var c,d=[],e=!1,f="";for(c=0;c<a.length;++c)f=a.charAt(c),e||"\\"!=f?e?(e=!1,d.push("'"+Box.String.escape(f)+"'")):d.push(b.getFormatCode(f)):e=!0;b.formatFunctions[a]=Box.functionFactory("return "+d.join("+"))},createParser:function(c){for(var d,e=b.parseRegexes.length,f=1,g=[],h=[],j=!1,k="",l=0,m=c.length,n=[];m>l;++l)k=c.charAt(l),j||"\\"!=k?j?(j=!1,h.push(Box.String.escape(k))):(d=b.formatCodeToRegex(k,f),f+=d.g,h.push(d.s),d.g&&d.c&&(d.calcAtEnd?n.push(d.c):g.push(d.c))):j=!0;g=g.concat(n),b.parseRegexes[e]=new RegExp("^"+h.join("")+"$","i"),b.parseFunctions[c]=Box.functionFactory("input","strict",a(i,e,g.join("")))},parseCodes:{d:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(3[0-1]|[1-2][0-9]|0[1-9])"},j:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(3[0-1]|[1-2][0-9]|[1-9])"},D:function(){for(var a=[],c=0;7>c;a.push(b.getShortDayName(c)),++c);return{g:0,c:null,s:"(?:"+a.join("|")+")"}},l:function(){return{g:0,c:null,s:"(?:"+b.dayNames.join("|")+")"}},N:{g:0,c:null,s:"[1-7]"},S:{g:0,c:null,s:"(?:st|nd|rd|th)"},w:{g:0,c:null,s:"[0-6]"},z:{g:1,c:"z = parseInt(results[{0}], 10);\n",s:"(\\d{1,3})"},W:{g:1,c:"W = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},F:function(){return{g:1,c:"m = parseInt(me.getMonthNumber(results[{0}]), 10);\n",s:"("+b.monthNames.join("|")+")"}},M:function(){for(var a=[],c=0;12>c;a.push(b.getShortMonthName(c)),++c);return Box.applyIf({s:"("+a.join("|")+")"},b.formatCodeToRegex("F"))},m:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(1[0-2]|0[1-9])"},n:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(1[0-2]|[1-9])"},t:{g:0,c:null,s:"(?:\\d{2})"},L:{g:0,c:null,s:"(?:1|0)"},o:{g:1,c:"y = parseInt(results[{0}], 10);\n",s:"(\\d{4})"},Y:{g:1,c:"y = parseInt(results[{0}], 10);\n",s:"(\\d{4})"},y:{g:1,c:"var ty = parseInt(results[{0}], 10);\ny = ty > me.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"},a:{g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(am|pm|AM|PM)",calcAtEnd:!0},A:{g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(AM|PM|am|pm)",calcAtEnd:!0},g:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(1[0-2]|[0-9])"},G:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(2[0-3]|1[0-9]|[0-9])"},h:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(1[0-2]|0[1-9])"},H:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(2[0-3]|[0-1][0-9])"},i:{g:1,c:"i = parseInt(results[{0}], 10);\n",s:"([0-5][0-9])"},s:{g:1,c:"s = parseInt(results[{0}], 10);\n",s:"([0-5][0-9])"},u:{g:1,c:"ms = results[{0}]; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n",s:"(\\d+)"},O:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(3,5) / 60),","mn = o.substring(3,5) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + Box.String.leftPad(hr, 2, '0') + Box.String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{4})"},P:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(4,6) / 60),","mn = o.substring(4,6) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + Box.String.leftPad(hr, 2, '0') + Box.String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{2}:\\d{2})"},T:{g:0,c:null,s:"[A-Z]{1,5}"},Z:{g:1,c:"zz = results[{0}] * 1;\nzz = (-43200 <= zz && zz <= 50400)? zz : null;\n",s:"([+-]?\\d{1,5})"},c:function(){var a,c,d=[],e=[b.formatCodeToRegex("Y",1),b.formatCodeToRegex("m",2),b.formatCodeToRegex("d",3),b.formatCodeToRegex("H",4),b.formatCodeToRegex("i",5),b.formatCodeToRegex("s",6),{c:"ms = results[7] || '0'; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n"},{c:["if(results[8]) {","if(results[8] == 'Z'){","zz = 0;","}else if (results[8].indexOf(':') > -1){",b.formatCodeToRegex("P",8).c,"}else{",b.formatCodeToRegex("O",8).c,"}","}"].join("\n")}];for(a=0,c=e.length;c>a;++a)d.push(e[a].c);return{g:1,c:d.join(""),s:[e[0].s,"(?:","-",e[1].s,"(?:","-",e[2].s,"(?:","(?:T| )?",e[3].s,":",e[4].s,"(?::",e[5].s,")?","(?:(?:\\.|,)(\\d+))?","(Z|(?:[-+]\\d{2}(?::)?\\d{2}))?",")?",")?",")?"].join("")}},U:{g:1,c:"u = parseInt(results[{0}], 10);\n",s:"(-?\\d+)"}},dateFormat:function(a,c){return b.format(a,c)},isEqual:function(a,b){return a&&b?a.getTime()===b.getTime():!(a||b)},format:function(a,c){var d=b.formatFunctions;return Box.isDate(a)?(null==d[c]&&b.createFormat(c),d[c].call(a)+""):""},getTimezone:function(a){return a.toString().replace(/^.* (?:\((.*)\)|([A-Z]{1,5})(?:[\-+][0-9]{4})?(?: -?\d+)?)$/,"$1$2").replace(/[^A-Z]/g,"")},getGMTOffset:function(a,b){var c=a.getTimezoneOffset();return(c>0?"-":"+")+Box.String.leftPad(Math.floor(Math.abs(c)/60),2,"0")+(b?":":"")+Box.String.leftPad(Math.abs(c%60),2,"0")},getDayOfYear:function(a){var c,d=0,e=Box.Date.clone(a),f=a.getMonth();for(c=0,e.setDate(1),e.setMonth(0);f>c;e.setMonth(++c))d+=b.getDaysInMonth(e);return d+a.getDate()-1},getWeekOfYear:function(){var a=864e5,b=7*a;return function(c){var d=Date.UTC(c.getFullYear(),c.getMonth(),c.getDate()+3)/a,e=Math.floor(d/7),f=new Date(e*b).getUTCFullYear();return e-Math.floor(Date.UTC(f,0,7)/b)+1}}(),isLeapYear:function(a){var b=a.getFullYear();return!(0!=(3&b)||!(b%100||b%400==0&&b))},getFirstDayOfMonth:function(a){var b=(a.getDay()-(a.getDate()-1))%7;return 0>b?b+7:b},getLastDayOfMonth:function(a){return b.getLastDateOfMonth(a).getDay()},getFirstDateOfMonth:function(a){return new Date(a.getFullYear(),a.getMonth(),1)},getLastDateOfMonth:function(a){return new Date(a.getFullYear(),a.getMonth(),b.getDaysInMonth(a))},getDaysInMonth:function(){var a=[31,28,31,30,31,30,31,31,30,31,30,31];return function(c){var d=c.getMonth();return 1==d&&b.isLeapYear(c)?29:a[d]}}(),getSuffix:function(a){switch(a.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},clone:function(a){return new Date(a.getTime())},isDST:function(a){return new Date(a.getFullYear(),0,1).getTimezoneOffset()!=a.getTimezoneOffset()},clearTime:function(a,c){if(c)return Box.Date.clearTime(Box.Date.clone(a));var d,e,f=a.getDate();if(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.getDate()!=f){for(d=1,e=b.add(a,Box.Date.HOUR,d);e.getDate()!=f;d++,e=b.add(a,Box.Date.HOUR,d));a.setDate(f),a.setHours(e.getHours())}return a},add:function(a,c,d){var e,f,g=Box.Date.clone(a),h=(Box.Date,0);if(!c||0===d)return g;if(f=d-parseInt(d,10),d=parseInt(d,10))switch(c.toLowerCase()){case Box.Date.MILLI:g.setTime(g.getTime()+d);break;case Box.Date.SECOND:g.setTime(g.getTime()+1e3*d);break;case Box.Date.MINUTE:g.setTime(g.getTime()+60*d*1e3);break;case Box.Date.HOUR:g.setTime(g.getTime()+60*d*60*1e3);break;case Box.Date.DAY:g.setDate(g.getDate()+d);break;case Box.Date.MONTH:e=a.getDate(),e>28&&(e=Math.min(e,Box.Date.getLastDateOfMonth(Box.Date.add(Box.Date.getFirstDateOfMonth(a),Box.Date.MONTH,d)).getDate())),g.setDate(e),g.setMonth(a.getMonth()+d);break;case Box.Date.YEAR:e=a.getDate(),e>28&&(e=Math.min(e,Box.Date.getLastDateOfMonth(Box.Date.add(Box.Date.getFirstDateOfMonth(a),Box.Date.YEAR,d)).getDate())),g.setDate(e),g.setFullYear(a.getFullYear()+d)}if(f){switch(c.toLowerCase()){case Box.Date.MILLI:h=1;break;case Box.Date.SECOND:h=1e3;break;case Box.Date.MINUTE:h=6e4;break;case Box.Date.HOUR:h=36e5;break;case Box.Date.DAY:h=864e5;break;case Box.Date.MONTH:e=b.getDaysInMonth(g),h=864e5*e;break;case Box.Date.YEAR:e=b.isLeapYear(g)?366:365,h=864e5*e}h&&g.setTime(g.getTime()+h*f)}return g},subtract:function(a,c,d){return b.add(a,c,-d)},between:function(a,b,c){var d=a.getTime();return b.getTime()<=d&&d<=c.getTime()},compat:function(){var a,c,d,e,f=window.Date,g=["useStrict","formatCodeToRegex","parseFunctions","parseRegexes","formatFunctions","y2kYear","MILLI","SECOND","MINUTE","HOUR","DAY","MONTH","YEAR","defaults","dayNames","monthNames","monthNumbers","getShortMonthName","getShortDayName","getMonthNumber","formatCodes","isValid","parseDate","getFormatCode","createFormat","createParser","parseCodes"],h=["dateFormat","format","getTimezone","getGMTOffset","getDayOfYear","getWeekOfYear","isLeapYear","getFirstDayOfMonth","getLastDayOfMonth","getDaysInMonth","getSuffix","clone","isDST","clearTime","add","between"],i=g.length,j=h.length;for(e=0;i>e;e++)c=g[e],f[c]=b[c];for(a=0;j>a;a++)d=h[a],f.prototype[d]=function(){var a=Array.prototype.slice.call(arguments);return a.unshift(this),b[d].apply(b,a)}}})},function(){Box.Date.monthNames=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],Box.Date.dayNames=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],Box.Date.formatCodes.a="(this.getHours() < 12 ? '上午' : '下午')",Box.Date.formatCodes.A="(this.getHours() < 12 ? '上午' : '下午')",parseCodes={g:1,c:"if (/(上午)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(上午|下午)",calcAtEnd:!0},Box.Date.parseCodes.a=Box.Date.parseCodes.A=parseCodes}();
Box.Function={clone:function(a){return function(){return a.apply(this,arguments)}},flexSetter:function(a){return function(b,c){if(Box.isEmpty(b))return this;var d,e=this;if("string"!=typeof b){for(d in b)b.hasOwnProperty(d)&&a.call(this,d,b[d]);Box.enumerables&&Box.Array.forEach(Box.enumerables,function(c){b.hasOwnProperty(c)&&a.call(e,c,b[c])})}else a.call(this,b,c);return this}},alias:function(a,b){return function(){return a[b].apply(a,arguments)}},bind:function(a,b,c,d){var e=a,f=Array.prototype.slice;return function(){var a=c||arguments;return d===!0?(a=f.call(arguments,0),a=a.concat(c)):"number"==typeof d&&(a=f.call(arguments,0),Box.Array.insert(a,d,c)),e.apply(b||window,a)}},mergeArgs:function(a,b,c){return b&&(b=Box.Array.toArray(b)),function(){return a.apply(c,Box.Array.toArray(arguments).concat(b))}},changeArgs:function(a,b){var c=a,d=arguments,e=d.length,f=Array.prototype.slice;return function(){for(var a=f.call(arguments,0),g=2;e>g;g++)a[d[g][0]]=d[g][1];return c.apply(b||window,a)}},callback:function(a,b,c,d){Box.isFunction(a)&&(c=c||[],b=b||window,d?Box.delay(a,d,b,c):a.apply(b,c))},defer:function(a,b,c,d,e){return a=Box.Function.bind(a,c,d,e),b>0?setTimeout(a,b):(a(),0)},createInterceptor:function(a,b,c,d){return Box.isFunction(b)?function(){var e=this,f=arguments;return b.target=e,b.method=a,b.apply(c||e||window,f)!==!1?a.apply(e||window,f):d||null}:a},createDelayed:function(a,b,c,d,e){return(c||d)&&(a=Box.Function.bind(a,c,d,e)),function(){var c=this;setTimeout(function(){a.apply(c,arguments)},b)}},createBuffered:function(a,b,c,d){return function(){var e;return function(){var f=this;e&&(clearInterval(e),e=null),e=setTimeout(function(){a.apply(c||f,d||arguments)},b)}}()},createSequence:function(a,b,c){return Box.isFunction(b)?function(){var d=a.apply(this||window,arguments);return b.apply(c||this||window,arguments),d}:a},createThrottled:function(a,b,c){var d,e,f,g,h=function(){a.apply(c||this,f),d=(new Date).getTime()};return function(){e=(new Date).getTime()-d,f=arguments,clearTimeout(g),!d||e>=b?h():g=setTimeout(h,b-e)}},factory:function(){var a=Array.prototype.slice.call(arguments);return Function.prototype.constructor.apply(Function.prototype,a)},pass:function(a,b,c){return b&&(b=Box.Array.from(b)),function(){return a.apply(c,b.concat(Box.Array.toArray(arguments)))}},before:function(a,b,c,d){var e=a[b]||Box.emptyFn;return a[b]=function(){var a=c.apply(d||this,arguments);return e.apply(this,arguments),a}},after:function(a,b,c,d){var e=a[b]||Box.emptyFn;return a[b]=function(){return e.apply(this,arguments),c.apply(d||this,arguments)}}},Box.defer=Box.Function.alias(Box.Function,"defer"),Box.pass=Box.Function.alias(Box.Function,"pass"),Box.bind=Box.Function.alias(Box.Function,"bind"),Box.callback=Box.Function.alias(Box.Function,"callback"),Box.functionFactory=Box.Function.alias(Box.Function,"factory");
!function(){var a=Math,b="1"!==.9.toFixed();Box.Number={constrain:function(b,c,d){return b=parseFloat(b),isNaN(c)||(b=a.max(b,c)),isNaN(d)||(b=a.min(b,d)),b},toFixed:function(c,d){if(b){d=d||0;var e=a.pow(10,d);return(a.round(c*e)/e).toFixed(d)}return c.toFixed(d)},num:function(a,b){return isFinite(a)&&(a=parseFloat(a)),isNaN(a)?b:a},from:function(a,b){return Box.Number.num(a,b)},randomInt:function(b,c){return a.floor(a.random()*(c-b+1)+b)},correctFloat:function(a){return parseFloat(a.toPrecision(14))},snap:function(a,b,c,d){var e;return void 0===a||c>a?c||0:(b&&(e=a%b,0!==e&&(a-=e,2*e>=b?a+=b:-b>2*e&&(a-=b))),Box.Number.constrain(a,c,d))}}}(),Box.num=Box.Number.num;
!function(){var a=function(){};Box.Object={chain:Object.create||function(b){a.prototype=b;var c=new a;return a.prototype=null,c},each:function(a,b,c){var d;c=c||a;for(d in a)if(a.hasOwnProperty(d)&&b.call(c,d,a[d],a)===!1)return},toQueryObjects:function(a,b,c){var d,e,f=Box.Object.toQueryObjects,g=[];if(Box.isArray(b))for(d=0,e=b.length;e>d;d++)c?g=g.concat(f(a+"["+d+"]",b[d],!0)):g.push({name:a,value:b[d]});else if(Box.isObject(b))for(d in b)b.hasOwnProperty(d)&&(c?g=g.concat(f(a+"["+d+"]",b[d],!0)):g.push({name:a,value:b[d]}));else g.push({name:a,value:b});return g},toQueryString:function(a,b){var c,d,e,f,g,h=[],i=[];for(c in a)a.hasOwnProperty(c)&&(h=h.concat(Box.Object.toQueryObjects(c,a[c],b)));for(d=0,e=h.length;e>d;d++)f=h[d],g=f.value,Box.isEmpty(g)?g="":Box.isDate(g)&&(g=Box.Date.toString(g)),i.push(encodeURIComponent(f.name)+"="+encodeURIComponent(String(g)));return i.join("&")},fromQueryString:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=a.replace(/^\?/,"").split("&"),r={};for(g=0,h=q.length;h>g;g++)if(i=q[g],i.length>0)if(d=i.split("="),e=decodeURIComponent(d[0]),f=void 0!==d[1]?decodeURIComponent(d[1]):"",b){if(l=e.match(/(\[):?([^\]]*)\]/g),m=e.match(/^([^\[]+)/),!m)throw new Error('[Box.Object.fromQueryString] Malformed query string given, failed parsing name from "'+i+'"');if(e=m[0],n=[],null===l){r[e]=f;continue}for(j=0,k=l.length;k>j;j++)o=l[j],o=2===o.length?"":o.substring(1,o.length-1),n.push(o);for(n.unshift(e),c=r,j=0,k=n.length;k>j;j++)o=n[j],j===k-1?Box.isArray(c)&&""===o?c.push(f):c[o]=f:((void 0===c[o]||"string"==typeof c[o])&&(p=n[j+1],c[o]=Box.isNumeric(p)||""===p?[]:{}),c=c[o])}else r.hasOwnProperty(e)?(Box.isArray(r[e])||(r[e]=[r[e]]),r[e].push(f)):r[e]=f;return r},merge:function(a,b,c){if(a=a||{},Box.isString(b))return Box.isObject(c)&&Box.isObject(a[b])?Box.Object.merge(a[b],c):a[b]=Box.isObject(c)?c:c,a;for(var d,e,f=arguments.length,g=0;f>g;g++){d=arguments[g]||{};var h=!1;for(e in d)h=!0;if(h)for(e in d)d.hasOwnProperty(e)&&Box.Object.merge(a,e,d[e])}return a},mergeIf:function(a){for(var b,c,d,e=1,f=arguments.length,g=Box.clone;f>e;e++){b=arguments[e];for(c in b)c in a||(d=b[c],a[c]=d&&d.constructor===Object?g(d):d)}return a},getKey:function(a,b){for(var c in a)if(a.hasOwnProperty(c)&&a[c]===b)return c;return null},getValues:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c},getKeys:"keys"in Object.prototype?Object.keys:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b);return c},getSize:function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},toStringBy:function(a,b,c){b=b||":",c=c||"|";var d=[];return Box.each(a,function(a,c){d.push(a+b+c)}),d.join(c)},isEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},equals:function(){var a=function(a,b){var c;for(c in a)if(a.hasOwnProperty(c)&&a[c]!==b[c])return!1;return!0};return function(b,c){return b===c?!0:b&&c?a(b,c)&&a(c,b):b||c?!1:b===c}}(),clone:function(a){return Box.clone(a)}},Box.merge=Box.Object.merge,Box.mergeIf=Box.Object.mergeIf,Box.urlEncode=function(){var a=Box.Array.from(arguments),b="";return"string"==typeof a[1]&&(b=a[1]+"&",a[1]=!1),b+Box.Object.toQueryString.apply(Box.Object,a)},Box.urlDecode=function(){return Box.Object.fromQueryString.apply(Box.Object,arguments)}}();
Box.String=function(){var a,b,c,d,e=/^[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+|[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+$/g,f=/('|\\)/g,g=/\{(\d+)\}/g,h=/([-.*+?\^${}()|\[\]\/\\])/g,i=/^\s+|\s+$/g,j=/\s+/,k=/(^[^a-z]*|[^\w])/gi,l=function(b,c){return a[c]},m=function(a,c){return c in b?b[c]:String.fromCharCode(parseInt(c.substr(2),10))},n=function(a,b){return null===a||void 0===a||null===b||void 0===b?!1:b.length<=a.length};return{EMPTY:"",has:function(a,b){return a.indexOf(b)>=0},firstUpperCase:function(a){return a.charAt(0).toUpperCase()+a.substr(1)},insert:function(a,b,c){if(!a)return b;if(!b)return a;var d=a.length;return c||0===c||(c=d),0>c&&(c*=-1,c=c>=d?0:d-c),0===c?a=b+a:c>=a.length?a+=b:a=a.substr(0,c)+b+a.substr(c),a},startsWith:function(a,b,c){var d=n(a,b);return d&&(c&&(a=a.toLowerCase(),b=b.toLowerCase()),d=0===a.lastIndexOf(b,0)),d},endsWith:function(a,b,c){var d=n(a,b);return d&&(c&&(a=a.toLowerCase(),b=b.toLowerCase()),d=-1!==a.indexOf(b,a.length-b.length)),d},createVarName:function(a){return a.replace(k,"")},htmlEncode:function(a){return a?String(a).replace(c,l):a},htmlDecode:function(a){return a?String(a).replace(d,m):a},addCharacterEntities:function(e){var f,g,h=[],i=[];for(f in e)g=e[f],b[f]=g,a[g]=f,h.push(g),i.push(f);c=new RegExp("("+h.join("|")+")","g"),d=new RegExp("("+i.join("|")+"|&#[0-9]{1,5};)","g")},resetCharacterEntities:function(){a={},b={},this.addCharacterEntities({"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'"})},urlAppend:function(a,b){return Box.isEmpty(b)?a:a+(-1===a.indexOf("?")?"?":"&")+b},trim:function(a){return a.replace(e,"")},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substr(1)},uncapitalize:function(a){return a.charAt(0).toLowerCase()+a.substr(1)},ellipsis:function(a,b,c){if(a&&a.length>b){if(c){var d=a.substr(0,b-2),e=Math.max(d.lastIndexOf(" "),d.lastIndexOf("."),d.lastIndexOf("!"),d.lastIndexOf("?"));if(-1!==e&&e>=b-15)return d.substr(0,e)+"..."}return a.substr(0,b-3)+"..."}return a},escapeRegex:function(a){return a.replace(h,"\\$1")},escape:function(a){return a.replace(f,"\\$1")},toggle:function(a,b,c){return a===b?c:b},leftPad:function(a,b,c){var d=String(a);for(c=c||" ";d.length<b;)d=c+d;return d},format:function(a){var b=Box.Array.toArray(arguments,1);return a.replace(g,function(a,c){return b[c]})},repeat:function(a,b,c){1>b&&(b=0);for(var d=[],e=b;e--;)d.push(a);return d.join(c||"")},splitWords:function(a){return a&&"string"==typeof a?a.replace(i,"").split(j):a||[]},parseVersion:function(a){var b,c,d={};return d.version=d.shortVersion=String(a).toLowerCase().replace(/_/g,".").replace(/[\-+]/g,""),c=d.version.search(/([^\d\.])/),-1!==c&&(d.release=d.version.substr(c,a.length),d.shortVersion=d.version.substr(0,c)),d.shortVersion=d.shortVersion.replace(/[^\d]/g,""),b=d.version.split("."),d.major=parseInt(b.shift()||0,10),d.minor=parseInt(b.shift()||0,10),d.patch=parseInt(b.shift()||0,10),d.build=parseInt(b.shift()||0,10),d},hasHtmlCharacters:function(a){return c.test(a)}}}(),Box.String.resetCharacterEntities(),Box.htmlEncode=Box.String.htmlEncode,Box.htmlDecode=Box.String.htmlDecode;
!function(a){var b=[],c=function(){},d=function(a,b,c,d){var e=function(){var b=this.callParent(arguments);return a.apply(this,arguments),b};return e.$name=c,e.$owner=d,b&&(e.$previous=b.$previous,b.$previous=e),e};Box.apply(c,{$className:"Box.Base",$isClass:!0,create:function(){return Box.create.apply(Box,[this].concat(Array.prototype.slice.call(arguments,0)))},extend:function(a){var b,c,d,e,f,g,h=a.prototype;if(c=this.prototype=Box.Object.chain(h),c.self=this,this.superclass=c.superclass=h,!a.$isClass){b=Box.Base.prototype;for(d in b)d in c&&(c[d]=b[d])}if(g=h.$inheritableStatics)for(d=0,e=g.length;e>d;d++)f=g[d],this.hasOwnProperty(f)||(this[f]=a[f]);a.$onExtended&&(this.$onExtended=a.$onExtended.slice())},$onExtended:[],triggerExtended:function(){var a,b,c=this.$onExtended,d=c.length;if(d>0)for(a=0;d>a;a++)b=c[a],b.fn.apply(b.scope||this,arguments)},onExtended:function(a,b){return this.$onExtended.push({fn:a,scope:b}),this},addStatics:function(a){var b,c;for(c in a)a.hasOwnProperty(c)&&(b=a[c],"function"!=typeof b||b.$isClass||b===Box.emptyFn||b===Box.identityFn||(b.$owner=this,b.$name=c,b.displayName=Box.getClassName(this)+"."+c),this[c]=b);return this},addInheritableStatics:function(a){var b,c,d,e,f=this.prototype;b=f.$inheritableStatics,c=f.$hasInheritableStatics,b||(b=f.$inheritableStatics=[],c=f.$hasInheritableStatics={});for(d in a)a.hasOwnProperty(d)&&(e=a[d],"function"==typeof e&&(e.displayName=Box.getClassName(this)+"."+d),this[d]=e,c[d]||(c[d]=!0,b.push(d)));return this},addMembers:function(a){var b,c,d,e,f=this.prototype,g=Box.enumerables,h=[];for(d in a)h.push(d);for(g&&h.push.apply(h,g),b=0,c=h.length;c>b;b++)d=h[b],a.hasOwnProperty(d)&&(e=a[d],"function"!=typeof e||e.$isClass||e===Box.emptyFn||e===Box.identityFn||(e.$owner=this,e.$name=d,e.displayName=(this.$className||"")+"#"+d),f[d]=e);return this},addMember:function(a,b){return"function"!=typeof b||b.$isClass||b===Box.emptyFn||b===Box.identityFn||(b.$owner=this,b.$name=a,b.displayName=(this.$className||"")+"#"+a),this.prototype[a]=b,this},implement:function(){this.addMembers.apply(this,arguments)},borrow:function(a,b){var c,d,e,f,g,h=this.prototype,i=a.prototype,j=Box.getClassName(this);for(b=Box.Array.from(b),c=0,d=b.length;d>c;c++)e=b[c],g=i[e],"function"==typeof g?(f=Box.Function.clone(g),j&&(f.displayName=j+"#"+e),f.$owner=this,f.$name=e,h[e]=f):h[e]=g;return this},override:function(a){var b,c,d,e,f,g,h=this,i=Box.enumerables,j=h.prototype,k=Box.Function.clone;2===arguments.length&&(b=a,a={},a[b]=arguments[1],i=null);do{f=[],e=null;for(b in a)"statics"==b?e=a[b]:"inheritableStatics"==b?h.addInheritableStatics(a[b]):f.push(b);for(i&&f.push.apply(f,i),c=f.length;c--;)b=f[c],a.hasOwnProperty(b)&&(d=a[b],"function"!=typeof d||d.$className||d===Box.emptyFn||d===Box.identityFn||("undefined"!=typeof d.$owner&&(d=k(d)),h.$className&&(d.displayName=h.$className+"#"+b),d.$owner=h,d.$name=b,g=j[b],g&&(d.$previous=g)),j[b]=d);j=h,a=e}while(a);return this},callParent:function(a){var c;return(c=this.callParent.caller)&&(c.$previous||(c=c.$owner?c:c.caller)&&c.$owner.superclass.self[c.$name]).apply(this,a||b)},callSuper:function(a){var c;return(c=this.callSuper.caller)&&((c=c.$owner?c:c.caller)&&c.$owner.superclass.self[c.$name]).apply(this,a||b)},mixin:function(a,b){var c,e,f,g,h,i,j,k,l=this,m=b.prototype,n=l.prototype;"undefined"!=typeof m.onClassMixedIn&&m.onClassMixedIn.call(b,l),n.hasOwnProperty("mixins")||(n.mixins="mixins"in n?Box.Object.chain(n.mixins):{});for(c in m)if(i=m[c],"mixins"===c)Box.merge(n.mixins,i);else if("xhooks"===c)for(j in i)k=i[j],k.$previous=Box.emptyFn,n.hasOwnProperty(j)?d(k,n[j],j,l):n[j]=d(k,null,j,l);else"mixinId"!==c&&"config"!==c&&void 0===n[c]&&(n[c]=i);if(e=m.$inheritableStatics)for(f=0,g=e.length;g>f;f++)h=e[f],l.hasOwnProperty(h)||(l[h]=b[h]);return n.mixins[a]=m,l},getName:function(){return Box.getClassName(this)},createAlias:a(function(a,b){this.override(a,function(){return this[b].apply(this,arguments)})}),addXtype:function(a){var b=this.prototype,c=b.xtypesMap,d=b.xtypes,e=b.xtypesChain;return b.hasOwnProperty("xtypesMap")||(c=b.xtypesMap=Box.merge({},b.xtypesMap||{}),d=b.xtypes=b.xtypes?[].concat(b.xtypes):[],e=b.xtypesChain=b.xtypesChain?[].concat(b.xtypesChain):[],b.xtype=a),c[a]||(c[a]=!0,d.push(a),e.push(a),Box.ClassManager.setAlias(this,"widget."+a)),this}}),c.implement({isInstance:!0,$className:"Box.Base",statics:function(){var a=this.statics.caller,b=this.self;return a?a.$owner:b},callParent:function(a){var c,d=(c=this.callParent.caller)&&(c.$previous||(c=c.$owner?c:c.caller)&&c.$owner.superclass[c.$name]);if(!d){c=this.callParent.caller;var e,f;if(!c.$owner){if(!c.caller)throw new Error("Attempting to call a protected method from the public scope, which is not allowed");c=c.caller}if(e=c.$owner.superclass,f=c.$name,!(f in e))throw new Error("this.callParent() was called but there's no such method ("+f+") found in the parent class ("+(Box.getClassName(e)||"Object")+")")}return d.apply(this,a||b)},callSuper:function(a){var c,d=(c=this.callSuper.caller)&&(c=c.$owner?c:c.caller)&&c.$owner.superclass[c.$name];if(!d){c=this.callSuper.caller;var e,f;if(!c.$owner){if(!c.caller)throw new Error("Attempting to call a protected method from the public scope, which is not allowed");c=c.caller}if(e=c.$owner.superclass,f=c.$name,!(f in e))throw new Error("this.callSuper() was called but there's no such method ("+f+") found in the parent class ("+(Box.getClassName(e)||"Object")+")")}return d.apply(this,a||b)},self:c,constructor:function(){return this},destroy:function(){this.destroy=Box.emptyFn}}),c.prototype.callOverridden=c.prototype.callParent,Box.Base=c}(Box.Function.flexSetter);
!function(){function a(a){function b(){return this.constructor.apply(this,arguments)||null}return a&&(b.displayName=a),b}var b,c,d,e=Box.Base,f=[];for(c in e)e.hasOwnProperty(c)&&f.push(c);d=f.length,Box.Class=b=function(a,c,d){return"function"!=typeof a&&(d=c,c=a,a=null),c=c||{},a=b.create(a,c),b.process(a,c,d),a},Box.apply(b,{onBeforeCreated:function(a,b,c){b.$configs={},a.addMembers(b),c.onCreated.call(a,a)},process:function(a,c,d){var e,f,g,h,i,j,k,l=c.preprocessors||b.defaultPreprocessors,m=this.preprocessors,n={onBeforeCreated:this.onBeforeCreated},o=[];for(delete c.preprocessors,g=0,h=l.length;h>g;g++)if(e=l[g],"string"==typeof e){if(e=m[e],f=e.properties,f===!0)o.push(e.fn);else if(f)for(i=0,j=f.length;j>i;i++)if(k=f[i],c.hasOwnProperty(k)){o.push(e.fn);break}}else o.push(e);n.onCreated=d?d:Box.emptyFn,n.preprocessors=o,this.doProcess(a,c,n)},doProcess:function(a,b,c){for(var d=this,e=c.preprocessors,f=e.shift(),g=d.doProcess;f;f=e.shift())if(f.call(d,a,b,c,g)===!1)return;c.onBeforeCreated.apply(d,arguments)},create:function(b,c){var g,h;for(b=b||a(c.$className),h=0;d>h;h++)g=f[h],b[g]=e[g];return b},preprocessors:{},registerPreprocessor:function(a,b,c,d,e){return d||(d="last"),c||(c=[a]),this.preprocessors[a]={name:a,properties:c||!1,fn:b},this.setDefaultPreprocessorPosition(a,d,e),this},getPreprocessor:function(a){return this.preprocessors[a]},getPreprocessors:function(){return this.preprocessors},defaultPreprocessors:[],getDefaultPreprocessors:function(){return this.defaultPreprocessors},setDefaultPreprocessors:function(a){return this.defaultPreprocessors=Box.Array.from(a),this},setDefaultPreprocessorPosition:function(a,b,c){var d,e=this.defaultPreprocessors;if("string"==typeof b){if("first"===b)return e.unshift(a),this;if("last"===b)return e.push(a),this;b="after"===b?1:-1}return d=Box.Array.indexOf(e,c),-1!==d&&Box.Array.splice(e,Math.max(0,d+b),0,a),this},configNameCache:{},getConfigNameMap:function(a){var b,c=this.configNameCache,d=c[a];return d||(b=a.charAt(0).toUpperCase()+a.substr(1),d=c[a]={internal:a,initialized:"_is"+b+"Initialized",apply:"apply"+b,update:"update"+b,set:"set"+b,get:"get"+b}),d}}),Box.Class.registerPreprocessor("extend",function(a,b){var c,d,e,f=Box.Base,g=f.prototype,h=b.extend;if(delete b.extend,c=h&&h!==Object?h:f,d=c.prototype,!c.$isClass)for(e in g)d[e]||(d[e]=g[e]);a.extend(c),a.triggerExtended.apply(a,arguments),b.onClassExtended&&(a.onExtended(b.onClassExtended,a),delete b.onClassExtended)},!0),Box.Class.registerPreprocessor("statics",function(a,b){a.addStatics(b.statics),delete b.statics}),Box.Class.registerPreprocessor("inheritableStatics",function(a,b){a.addInheritableStatics(b.inheritableStatics),delete b.inheritableStatics}),Box.Class.registerPreprocessor("config",function(a,b){var c=b.config,d=a.prototype;delete b.config,Box.Object.each(c,function(a,c){var e,f,g=Box.Class.getConfigNameMap(a),h=g.internal,i=g.initialized,j=g.apply,k=g.update,l=g.set,m=g.get,n=l in d||b.hasOwnProperty(l),o=j in d||b.hasOwnProperty(j),p=k in d||b.hasOwnProperty(k);null!==c&&(n||o||p)?d[i]=!1:(d[h]=c,d[i]=!0),n||(b[l]=function(a,b){var c=this[h],d=this[j],e=this[k];return this[i]||(this[i]=!0),d&&(a=d.call(this,a,c)),"undefined"==typeof a||b||(this[h]=a,e&&a!==c&&e.call(this,a,c)),this}),m in d&&!b.hasOwnProperty(m)||(f=b[m]||!1,e=f?function(){return f.apply(this,arguments)}:function(){return this[h]},b[m]=function(){var b;return this[i]||(this[i]=!0,this[l](this.config[a],!0)),b=this[m],"$previous"in b?b.$previous=e:this[m]=e,e.apply(this,arguments)})})}),Box.Class.registerPreprocessor("mixins",function(a,b,c){var d,e,f,g,h=b.mixins;delete b.mixins,Box.Function.before(c,"onCreated",function(){if(h instanceof Array)for(f=0,g=h.length;g>f;f++)e=h[f],d=e.prototype.mixinId||e.$className,a.mixin(d,e);else for(var b in h)h.hasOwnProperty(b)&&a.mixin(b,h[b])})}),Box.extend=function(a,c,d){2===arguments.length&&Box.isObject(c)&&(d=c,c=a,a=null);var e;if(!c)throw new Error("[Box.extend] Attempting to extend from a class which has not been loaded on the page.");return d.extend=c,d.preprocessors=["extend","statics","inheritableStatics","mixins"],a?(e=new b(a,d),e.prototype.constructor=a):e=new b(d),e.prototype.override=function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])},e}}();
!function(a,b,c,d,e){function f(){function a(){return this.constructor.apply(this,arguments)||null}return a}var g=Box.ClassManager={classes:{},existCache:{},fileCache:{},maps:{alternateToName:{},aliasToName:{},nameToAliases:{},nameToAlternates:{}},namespaceRewrites:[{from:"Box.",to:Box}],enableNamespaceParseCache:!0,namespaceParseCache:{},instantiators:[],isCreated:function(a){var b,c,d,f,g,h=this.existCache;if("string"!=typeof a||a.length<1)throw new Error("[Box.ClassManager] Invalid classname, must be a string and must not be empty");if(Box.String.has(a,"!"))return void 0!==this.fileCache[a];if(this.classes[a]||h[a])return!0;for(f=e,g=this.parseNamespace(a),b=0,c=g.length;c>b;b++)if(d=g[b],"string"!=typeof d)f=d;else{if(!f||!f[d])return!1;f=f[d]}return h[a]=!0,this.triggerCreated(a),!0},createdListeners:[],nameCreatedListeners:{},triggerCreated:function(a){var b,c,d,e,f,g,h=this.createdListeners,i=this.nameCreatedListeners,j=this.maps.nameToAlternates[a],k=[a];for(b=0,c=h.length;c>b;b++)f=h[b],f.fn.call(f.scope,a);for(j&&k.push.apply(k,j),b=0,c=k.length;c>b;b++)if(g=k[b],h=i[g]){for(d=0,e=h.length;e>d;d++)f=h[d],f.fn.call(f.scope,g);delete i[g]}},onCreated:function(a,b,c){var d=this.createdListeners,e=this.nameCreatedListeners,f={fn:a,scope:b};if(c){if(this.isCreated(c))return void a.call(b,c);e[c]||(e[c]=[]),e[c].push(f)}else d.push(f)},parseNamespace:function(a){if("string"!=typeof a)throw new Error("[Box.ClassManager] Invalid namespace, must be a string");var b,c,d,f,g,h,i,j,k,l=this.namespaceParseCache;if(this.enableNamespaceParseCache&&l.hasOwnProperty(a))return l[a];for(b=[],c=this.namespaceRewrites,d=e,f=a,j=0,k=c.length;k>j;j++)if(g=c[j],h=g.from,i=g.to,f===h||f.substring(0,h.length)===h){f=f.substring(h.length),"string"!=typeof i?d=i:b=b.concat(i.split("."));break}return b.push(d),b=b.concat(f.split(".")),this.enableNamespaceParseCache&&(l[a]=b),b},setNamespace:function(a,b){var c,d,f=e,g=this.parseNamespace(a),h=g.length-1,i=g[h];for(c=0;h>c;c++)d=g[c],"string"!=typeof d?f=d:(f[d]||(f[d]={}),f=f[d]);return f[i]=b,f[i]},createNamespaces:function(){var a,b,c,d,f,g,h=e;for(c=0,f=arguments.length;f>c;c++)for(a=this.parseNamespace(arguments[c]),d=0,g=a.length;g>d;d++)b=a[d],"string"!=typeof b?h=b:(h[b]||(h[b]={}),h=h[b]);return h},set:function(a,b){if(Box.String.has(a,"!"))return this.fileCache[a]=b,this;var c,d=this,e=d.maps,f=e.nameToAlternates,g=d.getName(b);return d.classes[a]=d.setNamespace(a,b),g&&g!==a&&(e.alternateToName[a]=g,c=f[g]||(f[g]=[]),c.push(a)),this},get:function(a){var b,c,d,f,g,h=this.classes;if(Box.String.has(a,"!"))return this.fileCache[a];if(h[a])return h[a];for(b=e,c=this.parseNamespace(a),f=0,g=c.length;g>f;f++)if(d=c[f],"string"!=typeof d)b=d;else{if(!b||!b[d])return null;b=b[d]}return b},setAlias:function(a,b){var c,d=this.maps.aliasToName,f=this.maps.nameToAliases;return c="string"==typeof a?a:this.getName(a),b&&d[b]!==c&&(d[b]&&Box.isDefined(e.console)&&e.console.log("[Box.ClassManager] Overriding existing alias: '"+b+"' of: '"+d[b]+"' with: '"+c+"'. Be sure it's intentional."),d[b]=c),f[c]||(f[c]=[]),b&&Box.Array.include(f[c],b),this},addNameAliasMappings:function(a){var b,c,d,e,f=this.maps.aliasToName,g=this.maps.nameToAliases;for(b in a)for(c=g[b]||(g[b]=[]),e=0;e<a[b].length;e++)d=a[b][e],f[d]||(f[d]=b,c.push(d));return this},addNameAlternateMappings:function(a){var b,c,d,e,f=this.maps.alternateToName,g=this.maps.nameToAlternates;for(b in a)for(c=g[b]||(g[b]=[]),e=0;e<a[b].length;e++)d=a[b][e],f[d]||(f[d]=b,c.push(d));return this},getByAlias:function(a){return this.get(this.getNameByAlias(a))},getNameByAlias:function(a){return this.maps.aliasToName[a]||""},getNameByAlternate:function(a){return this.maps.alternateToName[a]||""},getAliasesByName:function(a){return this.maps.nameToAliases[a]||[]},getName:function(a){return a&&a.$className||""},getClass:function(a){return a&&a.self||null},create:function(b,c,d){if(null!=b&&"string"!=typeof b)throw new Error("[Box.define] Invalid class name '"+b+"' specified, must be a non-empty string");var e=f();return"function"==typeof c&&(c=c(e)),b&&(e.displayName=b),c.$className=b,new a(e,c,function(){var a,e,f,h,i,j,k,l=c.postprocessors||g.defaultPostprocessors,m=g.postprocessors,n=[];for(delete c.postprocessors,e=0,f=l.length;f>e;e++)if(a=l[e],"string"==typeof a){if(a=m[a],j=a.properties,j===!0)n.push(a.fn);else if(j)for(h=0,i=j.length;i>h;h++)if(k=j[h],c.hasOwnProperty(k)){n.push(a.fn);break}}else n.push(a);c.postprocessors=n,c.createdFn=d,g.processCreate(b,this,c)})},processCreate:function(a,b,c){var d=this,e=c.postprocessors.shift(),f=c.createdFn;return e?void(e.call(d,a,b,c,d.processCreate)!==!1&&d.processCreate(a,b,c)):(a&&d.set(a,b),f&&f.call(b,b),void(a&&d.triggerCreated(a)))},createOverride:function(a,b,c){var d=this,e=b.override,f=b.requires,g=b.uses,h=function(){var i,j;f?(j=f,f=null,Box.Loader.require(j,h)):(i=d.get(e),delete b.override,delete b.requires,delete b.uses,Box.override(i,b),d.triggerCreated(a),g&&Box.Loader.addUsedClasses(g),c&&c.call(i))};return d.existCache[a]=!0,d.onCreated(h,d,e),d},instantiateByAlias:function(){var a=arguments[0],b=c.call(arguments),d=this.getNameByAlias(a);if(!d){if(d=this.maps.aliasToName[a],!d)throw new Error("[Box.createByAlias] Cannot create an instance of unrecognized alias: "+a);e.console&&e.console.warn("[Box.Loader] Synchronously loading '"+d+"'; consider adding Box.require('"+a+"') above Box.onReady"),Box.requireSync(d)}return b[0]=d,this.instantiate.apply(this,b)},instantiate:function(){var a,b,d=arguments[0],f=typeof d,g=c.call(arguments,1),h=d;if("function"!=f){if("string"!=f&&0===g.length&&(g=[d],d=d.xclass),"string"!=typeof d||d.length<1)throw new Error("[Box.create] Invalid class name or alias '"+d+"' specified, must be a non-empty string");b=this.get(d)}else b=d;if(b||(a=this.getNameByAlias(d),a&&(d=a,b=this.get(d))),b||(a=this.getNameByAlternate(d),a&&(d=a,b=this.get(d))),b||(e.console&&e.console.warn("[Box.Loader] Synchronously loading '"+d+"'; consider adding Box.require('"+(a?h:d)+"') above Box.onReady"),Box.requireSync(d),b=this.get(d)),!b)throw new Error("[Box.create] Cannot create an instance of unrecognized class name / alias: "+h);if("function"!=typeof b)throw new Error("[Box.create] '"+d+"' is a singleton and cannot be instantiated");return this.getInstantiator(g.length)(b,g)},dynInstantiate:function(a,b){return b=d(b,!0),b.unshift(a),this.instantiate.apply(this,b)},getInstantiator:function(a){var b,c,d,e=this.instantiators;if(b=e[a],!b){for(c=a,d=[],c=0;a>c;c++)d.push("a["+c+"]");b=e[a]=new Function("c","a","return new c("+d.join(",")+")"),b.displayName="Box.ClassManager.instantiate"+a}return b},postprocessors:{},defaultPostprocessors:[],registerPostprocessor:function(a,b,c,d,e){return d||(d="last"),c||(c=[a]),this.postprocessors[a]={name:a,properties:c||!1,fn:b},this.setDefaultPostprocessorPosition(a,d,e),this},setDefaultPostprocessors:function(a){return this.defaultPostprocessors=d(a),this},setDefaultPostprocessorPosition:function(a,b,c){var d,e=this.defaultPostprocessors;if("string"==typeof b){if("first"===b)return e.unshift(a),this;if("last"===b)return e.push(a),this;b="after"===b?1:-1}return d=Box.Array.indexOf(e,c),-1!==d&&Box.Array.splice(e,Math.max(0,d+b),0,a),this},getNamesByExpression:function(a){var b,c,d,e,f,g,h,i=this.maps.nameToAliases,j=[];if("string"!=typeof a||a.length<1)throw new Error("[Box.ClassManager.getNamesByExpression] Expression "+a+" is invalid, must be a non-empty string");if(-1!==a.indexOf("*")){a=a.replace(/\*/g,"(.*?)"),f=new RegExp("^"+a+"$");for(b in i)if(i.hasOwnProperty(b))if(d=i[b],-1!==b.search(f))j.push(b);else for(g=0,h=d.length;h>g;g++)if(c=d[g],-1!==c.search(f)){j.push(b);break}}else e=this.getNameByAlias(a),e?j.push(e):(e=this.getNameByAlternate(a),j.push(e?e:a));return j}};g.registerPostprocessor("alias",function(a,c,d){var e,f,g=d.alias;for(e=0,f=g.length;f>e;e++)b=g[e],this.setAlias(c,b)},["xtype","alias"]),g.registerPostprocessor("singleton",function(a,b,c,d){return c.singleton?(d.call(this,a,b=new b,c),!1):!0}),g.registerPostprocessor("alternateClassName",function(a,b,c){var d,e,f,g=c.alternateClassName;for(g instanceof Array||(g=[g]),d=0,e=g.length;e>d;d++){if(f=g[d],"string"!=typeof f)throw new Error("[Box.define] Invalid alternate of: '"+f+"' for class: '"+a+"'; must be a valid string");this.set(f,b)}}),Box.apply(Box,{create:b(g,"instantiate"),createByAlias:b(g,"instantiateByAlias"),define:function(a,b){if(!Box.String.startsWith(a,"Box.")){var c=Box.app.Application.name+".";Box.String.startsWith(a,c)||Box.Error("the module name ["+a+"] is error, module name must start with ["+c+"]")}return b.override?g.createOverride.apply(g,arguments):g.create.apply(g,arguments)},getClassName:b(g,"getName"),getDisplayName:function(a){if(a){if(a.displayName)return a.displayName;if(a.$name&&a.$class)return Box.getClassName(a.$class)+"#"+a.$name;if(a.$className)return a.$className}return"Anonymous"},getClass:b(g,"getClass")}),a.registerPreprocessor("className",function(a,b){b.$className&&(a.$className=b.$className,a.displayName=a.$className)},!0,"first")}(Box.Class,Box.Function.alias,Array.prototype.slice,Box.Array.from,Box.global);
Box.Loader=new function(){var a=this,b=Box.ClassManager,c=Box.Class,d=Box.Function.flexSetter,e=Box.Function.alias,f=(Box.Function.pass,Box.Function.defer),g=Box.Array.erase,h="undefined"==typeof window,i=(h&&"function"==typeof require,h&&"undefined"!=typeof system&&-1!==system.program.search(/jsdb/),"undefined"!=typeof phantom&&phantom.fs),j=["extend","mixins","requires"],k={},l=[],m=/\/\.\//g,n=/\./g,o=0;Box.apply(a,{isInHistory:k,history:l,namespaces:{},collectNamespaces:function(b){var c,d=a.namespaces;for(c in b)b.hasOwnProperty(c)&&(d[c]=!0)},addNamespaces:function(b){var c,d,e=a.namespaces;for(Box.isArray(b)||(b=[b]),c=0,d=b.length;d>c;c++)e[b[c]]=!0},clearNamespaces:function(){a.namespaces={}},getNamespace:function(b){var c,d=a.namespaces,e="";for(c in d)d.hasOwnProperty(c)&&c.length>e.length&&c+"."===b.substring(0,c.length+1)&&(e=c);return""===e?void 0:e},config:{enabled:!1,scriptChainDelay:!1,disableCaching:!0,disableCachingParam:"_dc",garbageCollect:!1,paths:{Box:"."},preserveScripts:!0,scriptCharset:void 0},setConfig:function(b,c){return Box.isObject(b)&&1===arguments.length?(Box.merge(a.config,b),"paths"in b&&a.collectNamespaces(b.paths)):(a.config[b]=Box.isObject(c)?Box.merge(a.config[b],c):c,"paths"===b&&a.collectNamespaces(c)),a},getConfig:function(b){return b?a.config[b]:a.config},addClassPathMappings:function(b){var c;if(0==o)a.config.paths=b;else for(c in b)a.config.paths[c]=b[c];return o++,a},setPath:d(function(b,c){return a.config.paths[b]=c,a.namespaces[b]=!0,o++,a}),getPath:function(b){var c="",d=a.config.paths,e=a.getPrefix(b);if(e.length>0){if(e===b)return d[e];c=d[e],b=b.substring(e.length+1)}return c.length>0&&(c+="/"),c.replace(m,"/")+b.replace(n,"/")+".js"},getPrefix:function(b){var c,d=a.config.paths,e="";if(d.hasOwnProperty(b))return b;for(c in d)d.hasOwnProperty(c)&&c+"."===b.substring(0,c.length+1)&&c.length>e.length&&(e=c);return e},isAClassNameWithAKnownPrefix:function(b){var c=a.getPrefix(b);return""!==c&&c!==b},require:function(a,b,c){b&&b.call(c)},requireSync:function(){},exclude:function(){return{require:function(b,c,d,e){return a.require(b,c,d,e)},requireSync:function(b,c,d,e){return a.requireSync(b,c,d,e)}}},onReady:function(a,b,c){var d;c!==!1&&Box.DOM_QUERY&&(d=a,a=function(){Box.DOM_QUERY(document).ready(Box.bind(d,b))}),a.call(b)}});var p=[],q={},r={},s={},t={},u=[],v=[],w={},x={},y=function(a,b){return b.priority-a.priority};Box.apply(a,{documentHead:"undefined"!=typeof document&&(document.head||document.getElementsByTagName("head")[0]),isLoading:!1,queue:p,isClassFileLoaded:q,readyListeners:u,optionalRequires:v,requiresMap:w,numPendingFiles:0,numLoadedFiles:0,hasFileLoadError:!1,classNameToFilePathMap:s,scriptsLoading:0,syncModeEnabled:!1,scriptElements:t,refreshQueue:function(){var c,d,e,f,h=p.length;if(!h&&!a.scriptsLoading)return a.triggerReady();for(c=0;h>c;c++)if(d=p[c]){if(f=d.requires,f.length>a.numLoadedFiles)continue;for(e=0;e<f.length;)b.isCreated(f[e])?(d.objects=d.objects||[],d.objects.push(b.get(f[e])),g(f,e,1)):e++;if(0===d.requires.length){g(p,c,1),d.callback.apply(d.scope,d.objects||[]),a.refreshQueue();break}}return a},injectScriptElement:function(b,c,d,e,g){var h=document.createElement("script"),i=!1,j=a.config,k=function(){i||(i=!0,h.onload=h.onreadystatechange=h.onerror=null,"number"==typeof j.scriptChainDelay?f(c,j.scriptChainDelay,e):c.call(e),a.cleanupScriptElement(h,j.preserveScripts===!1,j.garbageCollect))},l=function(){f(d,1,e),a.cleanupScriptElement(h,j.preserveScripts===!1,j.garbageCollect)};return h.type="text/javascript",h.onerror=l,g=g||j.scriptCharset,g&&(h.charset=g),"addEventListener"in h?h.onload=k:"readyState"in h?h.onreadystatechange=function(){("loaded"==this.readyState||"complete"==this.readyState)&&k()}:h.onload=k,h.src=b,(a.documentHead||document.getElementsByTagName("head")[0]).appendChild(h),h},removeScriptElement:function(b){return t[b]&&(a.cleanupScriptElement(t[b],!0,!!a.getConfig("garbageCollect")),delete t[b]),a},cleanupScriptElement:function(b,c,d){var e;if(b.onload=b.onreadystatechange=b.onerror=null,c&&(Box.DOM_QUERY(b).remove(),d))for(e in b)try{"src"!=e&&(b[e]=null),delete b[e]}catch(f){}return a},loadScript:function(b){var c,d=a.getConfig(),e="string"==typeof b,f=e?b:b.url,g=!e&&b.onError,h=!e&&b.onLoad,i=!e&&b.scope,j=function(){a.numPendingFiles--,a.scriptsLoading--,g&&g.call(i,"Failed loading '"+f+"', please verify that the file exists"),a.numPendingFiles+a.scriptsLoading===0&&a.refreshQueue()},k=function(){a.numPendingFiles--,a.scriptsLoading--,h&&h.call(i),a.numPendingFiles+a.scriptsLoading===0&&a.refreshQueue()};a.isLoading=!0,a.numPendingFiles++,a.scriptsLoading++,c=d.disableCaching?f+"?"+d.disableCachingParam+"="+Box.Date.now():f,t[f]=a.injectScriptElement(c,k,j)},loadScriptFile:function(b,c,d,e,f){if(r[b])return a;var g,h,j,k=a.getConfig(),l=b+(k.disableCaching?"?"+k.disableCachingParam+"="+Box.Date.now():""),m=!1,n="";if(e=e||a,a.isLoading=!0,f){g="undefined"!=typeof XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");try{g.open("GET",l,!1),g.send(null)}catch(o){m=!0}h=1223===g.status?204:0!==g.status||"file:"!=(self.location||{}).protocol&&"ionp:"!=(self.location||{}).protocol?g.status:200,m=m||0===h,m&&!i?d.call(a,"Failed loading synchronously via XHR: '"+b+"'; It's likely that the file is either being loaded from a different domain or from the local file system whereby cross origin requests are not allowed due to security reasons. Use asynchronous loading with Box.require instead.",f):h>=200&&300>h||304===h||i?(Box.browser.is.IE||(n="\n//@ sourceURL="+b),Box.globalEval(g.responseText+n),c.call(e)):d.call(a,"Failed loading synchronously via XHR: '"+b+"'; please verify that the file exists. XHR status code: "+h,f),g=null}else j=function(){d.call(e,"Failed loading '"+b+"', please verify that the file exists",f)},t[b]=a.injectScriptElement(l,c,j,e)},requireSync:function(){var b=a.syncModeEnabled;b||(a.syncModeEnabled=!0);var c=a.require.apply(a,arguments);return b||(a.syncModeEnabled=!1),a.refreshQueue(),c},require:function(c,d,e,f){var g,h,i,j,k,l,m,n,o,q,r={},s={},t=[],u=[],v=[],w=[];if(f)for(f="string"==typeof f?[f]:f,m=0,o=f.length;o>m;m++)if(j=f[m],"string"==typeof j&&j.length>0)for(t=b.getNamesByExpression(j),n=0,q=t.length;q>n;n++)r[t[n]]=!0;for(c="string"==typeof c?[c]:c?c:[],g=d?function(){var a,c,e=[];for(a=0,c=w.length;c>a;a++)e.push(b.get(w[a]));return d.apply(this,e)}:Box.emptyFn,e=e||Box.global,m=0,o=c.length;o>m;m++)if(i=c[m],"string"==typeof i&&i.length>0)for(u=b.getNamesByExpression(i),q=u.length,n=0;q>n;n++)l=u[n],r[l]!==!0&&(w.push(l),b.isCreated(l)||s[l]||(s[l]=!0,v.push(l)));if(!(v.length>0))return g.call(e),1==w.length?b.get(w[0]):a;if(!a.config.enabled)throw new Error("Box.Loader is not enabled, so dependencies cannot be resolved dynamically. Missing required class"+(v.length>1?"es":"")+": "+v.join(", "));for(h=a.syncModeEnabled,h||p.push({requires:v.slice(),callback:g,scope:e}),o=v.length,m=0;o>m;m++){k=v[m];var x=a.resolve(k);x.exec(k)}return h&&(g.call(e),1===o)?b.get(k):a},resolve:function(a){var b="js";return Box.String.has(a,"!")&&(b=a.split("!")[0]),{type:b,exec:x[b]}},onFileLoaded:function(b,c){var d=q[b];if(a.numLoadedFiles++,q[b]=!0,r[c]=!0,d||a.numPendingFiles--,0===a.numPendingFiles&&a.refreshQueue(),!a.syncModeEnabled&&0===a.numPendingFiles&&a.isLoading&&!a.hasFileLoadError){var e,f,g,h,i,j=[],k=[];for(f=0,g=p.length;g>f;f++)for(e=p[f].requires,h=0,i=e.length;i>h;h++)q[e[h]]&&j.push(e[h]);if(j.length<1)return;if(j=Box.Array.filter(Box.Array.unique(j),function(a){return!w.hasOwnProperty(a)},a),j.length<1)return;for(f=0,g=j.length;g>f;f++)k.push(s[j[f]]);throw new Error("The following classes are not declared even if their files have been loaded: '"+j.join("', '")+"'. Please check the source code of their corresponding files for possible typos: '"+k.join("', '"))}},onFileLoadError:function(b,c,d){throw a.numPendingFiles--,a.hasFileLoadError=!0,new Error("[Box.Loader] "+d)},addUsedClasses:function(b){var c,d,e;if(b)for(b="string"==typeof b?[b]:b,d=0,e=b.length;e>d;d++)c=b[d],"string"!=typeof c||Box.Array.contains(v,c)||v.push(c);return a},registerRequireTypeParse:function(a,b){x[a]=b},triggerReady:function(){var b,c=v;if(a.isLoading&&(a.isLoading=!1,0!==c.length))return c=c.slice(),v.length=0,a.require(c,a.triggerReady,a),a;for(Box.Array.sort(u,y);u.length&&!a.isLoading;)b=u.shift(),b.fn.call(b.scope);return a},onReady:function(b,c,d,e){var f;d!==!1&&Box.DOM_QUERY&&(f=b,b=function(){Box.DOM_QUERY(document).ready(Box.bind(f,c))}),a.isLoading?u.push({fn:b,scope:c,priority:e&&e.priority||0}):b.call(c)},historyPush:function(b){return b&&q.hasOwnProperty(b)&&!k[b]&&(k[b]=!0,l.push(b)),a}}),Box.require=e(a,"require"),Box.requireSync=e(a,"requireSync"),Box.exclude=e(a,"exclude"),Box.onReady=function(b,c,d){a.onReady(b,c,!0,d)},c.registerPreprocessor("loader",function(c,d,e,f){var g,h,i,k,l,m,n,o,p,q=this,r=[],s=b.getName(c);for(h=0,k=j.length;k>h;h++)if(n=j[h],d.hasOwnProperty(n))if(o=d[n],"string"==typeof o)r.push(o);else if(o instanceof Array)for(i=0,l=o.length;l>i;i++)m=o[i],"string"==typeof m&&r.push(m);else if("function"!=typeof o)for(i in o)o.hasOwnProperty(i)&&(m=o[i],"string"==typeof m&&r.push(m));if(0!==r.length){var t,u=[];if(s){for(w[s]=r,p=a.requiredByMap||(a.requiredByMap={}),h=0,k=r.length;k>h;h++)g=r[h],(p[g]||(p[g]=[])).push(s);t=function(a){if(u.push(a),w[a]){if(Box.Array.contains(w[a],s))throw new Error("Deadlock detected while loading dependencies! '"+s+"' and '"+u[1]+"' mutually require each other. Path: "+u.join(" -> ")+" -> "+u[0]);for(h=0,k=w[a].length;k>h;h++)t(w[a][h])}},t(s)}return a.require(r,function(){for(h=0,k=j.length;k>h;h++)if(n=j[h],d.hasOwnProperty(n))if(o=d[n],"string"==typeof o)d[n]=b.get(o);else if(o instanceof Array)for(i=0,l=o.length;l>i;i++)m=o[i],"string"==typeof m&&(d[n][i]=b.get(m));else if("function"!=typeof o)for(var a in o)o.hasOwnProperty(a)&&(m=o[a],"string"==typeof m&&(d[n][a]=b.get(m)));f.call(q,c,d,e)}),!1}},!0,"after","className"),b.registerPostprocessor("uses",function(b,c,d){var e=d.uses;e&&a.addUsedClasses(e)}),b.onCreated(a.historyPush)},Box.Loader.setConfig({enabled:!0,disableCaching:/[?&](?:cache|disableCacheBuster)\b/i.test(location.search)||/(^|[ ;])ext-cache=1/.test(document.cookie)?!1:!0,paths:{Box:"src"}});
!function(){function a(a,b){var d=Box.global.XMLHttpRequest?new Box.global.XMLHttpRequest:new Box.global.ActiveXObject("Microsoft.XMLHTTP");c.numPendingFiles++,d.open("GET",a,!1),d.send(null);1223===d.status?204:0===d.status?200:d.status;b(d.responseText),c.numLoadedFiles++,c.numPendingFiles--,c.numPendingFiles+c.scriptsLoading===0&&c.refreshQueue()}function b(b,d){if(Box.String.has(b,"!")){var e=b.split("!")[1];a(e,function(a){Box.ClassManager.set(b,function(){return d.call(c,a)}())})}}var c=Box.Loader,d=Box.Function.pass,e=c.isClassFileLoaded,f=c.classNameToFilePathMap;c.registerRequireTypeParse("js",function(a){var b=c.getPath(a),g=c.syncModeEnabled;g&&e.hasOwnProperty(a)&&(e[a]||(c.numPendingFiles--,c.removeScriptElement(b),delete e[a])),e.hasOwnProperty(a)||(e[a]=!1,f[a]=b,c.numPendingFiles++,c.loadScriptFile(b,d(c.onFileLoaded,[a,b],c),d(c.onFileLoadError,[a,b],c),c,g))}),c.registerRequireTypeParse("text",function(a){b(a,function(a){return a})}),c.registerRequireTypeParse("json",function(a){b(a,function(a){return Box.globalEval("("+a+")")})}),c.registerRequireTypeParse("handlebars",function(a){b(a,function(a){return Handlebars.compile(a)})})}();
Box.define("Box.env.Browser",{statics:{browserNames:{ie:"IE",firefox:"Firefox",safari:"Safari",chrome:"Chrome",opera:"Opera",other:"Other"},engineNames:{webkit:"WebKit",gecko:"Gecko",presto:"Presto",trident:"Trident",other:"Other"},enginePrefixes:{webkit:"AppleWebKit/",gecko:"Gecko/",presto:"Presto/",trident:"Trident/"},browserPrefixes:{ie:"MSIE ",firefox:"Firefox/",chrome:"Chrome/",safari:"Version/",opera:"Opera/"}},isSecure:/^https/i.test(Box.global.location.protocol),isStrict:"CSS1Compat"===Box.global.document.compatMode,name:null,engineName:null,is:Box.emptyFn,constructor:function(){var a,b,c=this.userAgent=Box.global.navigator.userAgent,d=this.statics(),e=c.match(new RegExp("((?:"+Box.Object.getValues(d.browserPrefixes).join(")|(?:")+"))([\\d\\._]+)")),f=c.match(new RegExp("((?:"+Box.Object.getValues(d.enginePrefixes).join(")|(?:")+"))([\\d\\._]+)")),g=d.browserNames.other,h="",i=d.engineNames.other,j="";this.is=function(a){return this.is[a]===!0},e&&(g=d.browserNames[Box.Object.getKey(d.browserPrefixes,e[1])],h=e[2]),f&&(i=d.engineNames[Box.Object.getKey(d.enginePrefixes,f[1])],j=f[2]),Box.apply(this,{name:g,engineVersion:Box.String.parseVersion(j),engineName:i,version:Box.String.parseVersion(h)}),this.is[this.name]=!0,this.is[this.name+(this.version.major||"")]=!0,this.is[this.name+this.version.shortVersion]=!0;for(a in d.browserNames)d.browserNames.hasOwnProperty(a)&&(b=d.browserNames[a],this.is[b]=this.name===b);this.is[this.name]=!0,this.is[this.engineName+(this.engineVersion.major||"")]=!0,this.is[this.engineName+this.engineVersion.shortVersion]=!0;for(a in d.engineNames)d.engineNames.hasOwnProperty(a)&&(b=d.engineNames[a],this.is[b]=this.engineName===b);return this}},function(){Box.browser=new Box.env.Browser,Box.isStrict=Box.browser.isStrict});
Box.define("Box.env.FeatureDetector",{statics:{tests:{Canvas:function(){var a=this.getTestElement("canvas");return!!(a&&a.getContext&&a.getContext("2d"))},SVG:function(){var a=Box.global.document;return!(!a.createElementNS||!a.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect)},VML:function(){var a=this.getTestElement(),b=!1;return a.innerHTML="<!--[if vml]><br/><br/><![endif]-->",b=2===a.childNodes.length,a.innerHTML="",b},Touch:function(){return"ontouchstart"in Box.global&&!(Box.platform&&Box.platform.name.match(/Windows|MacOSX|Linux/))},Orientation:function(){return"orientation"in Box.global},Geolocation:function(){return!!Box.global.navigator.geolocation},SqlDatabase:function(){return!!Box.global.openDatabase},Websockets:function(){return"WebSocket"in Box.global},History:function(){return!(!Box.global.history||!Box.global.history.pushState)},CSSTransforms:function(){return this.isStyleSupported("transform")},CSS3DTransforms:function(){return this.has("csstransforms")&&this.isStyleSupported("perspective")},CSSAnimations:function(){return this.isStyleSupported("animationName")},CSSTransitions:function(){return this.isStyleSupported("transitionProperty")},Audio:function(){return!!this.getTestElement("audio").canPlayType},Video:function(){return!!this.getTestElement("video").canPlayType}},stylePrefixes:["Webkit","Moz","O","ms"]},tests:{},testElements:{},constructor:function(){return this.registerTests(this.statics().tests,!0),this},has:function(a){return this.hasTest(a)?this.has.hasOwnProperty(a)?this.has[a]:this.getTestResult(a):!1},getTestResult:function(a){return!!this.getTest(a).call(this)},getTestElement:function(a){return a||(a="div"),this.testElements[a]||(this.testElements[a]=Box.global.document.createElement(a)),this.testElements[a]},registerTest:function(a,b,c){return this.hasTest(a)&&Box.Error({className:"Box.env.FeatureDetector",methodName:"registerTest",error:"Test name "+a+" has already been registered"}),this.tests[a]=b,c&&(this.has[a]=this.getTestResult(a)),this},registerTests:function(a,b){var c;for(c in a)a.hasOwnProperty(c)&&this.registerTest(c,a[c],b);return this},hasTest:function(a){return this.tests.hasOwnProperty(a)},getTest:function(a){return this.hasTest(a)||Box.Error({className:"Box.env.FeatureDetector",methodName:"getTest",error:"Test name "+a+" does not exist"}),this.tests[a]},getTests:function(){return this.tests},isStyleSupported:function(a,b){var c=this.getTestElement(b).style,d=Box.String.capitalize(a),e=this.statics().stylePrefixes.length;if(void 0!==c[a])return!0;for(;e--;)if(void 0!==c[this.statics().stylePrefixes[e]+d])return!0;return!1},isEventSupported:function(a,b){var c=this.getTestElement(b),d="on"+a,e=!1;return e=d in c,e||c.setAttribute&&c.removeAttribute&&(c.setAttribute(d,""),e="function"==typeof c[d],"undefined"!=typeof c[d]&&(c[d]=void 0),c.removeAttribute(d)),e}},function(){Box.features=new Box.env.FeatureDetector});
Box.define("Box.dom.Element",function(){function a(){return Box.browser.is.IE6||Box.browser.is.IE7||Box.browser.is.IE8||Box.browser.is.IE9}var b=document,c=null,d="CSS1Compat"==b.compatMode;return"activeElement"in b||!b.addEventListener||b.addEventListener("focus",function(a){a&&a.target&&(c=a.target==b?null:a.target)},!0),{singleton:!0,get:function(a,b){return Box.DOM_QUERY(a,b)},getDom:function(a){return Box.isElement(a)?a:Box.isString(a)?Box.DOM_QUERY(a)[0]:a.jquery?a[0]:null},defaultUnit:"px",cssRe:/([a-z0-9\-]+)\s*:\s*([^;\s]+(?:\s*[^;\s]+)*)?;?/gi,unitRe:/\d+(px|em|%|en|ex|pt|in|cm|mm|pc)$/i,borders:{l:"border-left-width",r:"border-right-width",t:"border-top-width",b:"border-bottom-width"},paddings:{l:"padding-left",r:"padding-right",t:"padding-top",b:"padding-bottom"},margins:{l:"margin-left",r:"margin-right",t:"margin-top",b:"margin-bottom"},userAgent:navigator.userAgent.toLowerCase(),idSeed:1e3,windowId:"box-window",documentId:"box-document",id:function(a,b){var c="";return a=this.getDom(a),a===document?a.id=this.documentId:a===window&&(a.id=this.windowId),a.id=a.id||c+(b||"box-gen")+ ++Box.idSeed,a.id},contains:function(a,b){var c=!1;if(a=this.getDom(a),b=this.getDom(b),!Box.isElement(a)||!Box.isElement(b))return!1;if(a===b)return!0;if(a&&b){if(a.contains)return a.contains(b);if(a.compareDocumentPosition)return!!(16&a.compareDocumentPosition(b));for(;b=b.parentNode;)c=b==a||c}return c},addUnits:function(a,b){return"number"==typeof a?a+(b||this.defaultUnit||"px"):""===a||"auto"==a||void 0===a||null===a?a||"":this.unitRe.test(a)?a:(Box.log("warn","Warning, size detected as NaN on Element.addUnits."),a||"")},parseBox:function(a){a=a||0;var b,c,d=typeof a;return"number"===d?{top:a,right:a,bottom:a,left:a}:"string"!==d?a:(b=a.split(" "),c=b.length,1==c?b[1]=b[2]=b[3]=b[0]:2==c?(b[2]=b[0],b[3]=b[1]):3==c&&(b[3]=b[1]),{top:parseFloat(b[0])||0,right:parseFloat(b[1])||0,bottom:parseFloat(b[2])||0,left:parseFloat(b[3])||0})},unitizeBox:function(a,b){var c=this.parseBox(a);return this.addUnits(c.top,b)+" "+this.addUnits(c.right,b)+" "+this.addUnits(c.bottom,b)+" "+this.addUnits(c.left,b)},parseStyles:function(a){var b,c={},d=this.cssRe;if(a)for(d.lastIndex=0;b=d.exec(a);)c[b[1]]=b[2]||"";return c},getActiveElement:function(){var a;try{a=document.activeElement}catch(b){}return a=a||c,a||(a=c=document.body),a},getViewWidth:function(a){return a?this.getDocumentWidth():this.getViewportWidth()},getViewHeight:function(a){return a?this.getDocumentHeight():this.getViewportHeight()},getDocumentHeight:function(){return Math.max(d?b.documentElement.scrollHeight:b.body.scrollHeight,this.getViewportHeight())},getDocumentWidth:function(){return Math.max(d?b.documentElement.scrollWidth:b.body.scrollWidth,this.getViewportWidth())},getViewportHeight:function(){return a()?Box.isStrict?b.documentElement.clientHeight:b.body.clientHeight:window.innerHeight},getViewportWidth:function(){return Box.isStrict||Box.browser.is.Opera?a()?b.documentElement.clientWidth:window.innerWidth:b.body.clientWidth},getViewSize:function(a){return{width:this.getViewWidth(a),height:this.getViewHeight(a)}},serializeForm:function(a){var b,c,d,e,f,g,h,i,j,k=a.elements||(document.forms[a]||this.getDom(a)).elements,l=!1,m=encodeURIComponent,n="",o=k.length;for(g=0;o>g;g++)if(b=k[g],c=b.name,d=b.type,e=b.options,!b.disabled&&c)if(/select-(one|multiple)/i.test(d))for(i=e.length,h=0;i>h;h++)j=e[h],j.selected&&(f=j.hasAttribute?j.hasAttribute("value"):j.getAttributeNode("value").specified,n+=Box.String.format("{0}={1}&",m(c),m(f?j.value:j.text)));else/file|undefined|reset|button/i.test(d)||/radio|checkbox/i.test(d)&&!b.checked||"submit"==d&&l||(n+=m(c)+"="+m(b.value)+"&",l=/submit/i.test(d));return n.substr(0,n.length-1)},getDoc:function(){var a;return function(){return a||(a=Box.dom.Element.get(document))}}(),getBody:function(){var a;return function(){return a||(a=Box.dom.Element.get(document.body))}}(),getHead:function(){var a;return function(){return a||(a=Box.dom.Element.get(document.getElementsByTagName("head")[0]))}}(),isScrollable:function(a){var b=Box.getDom(a);return b.scrollHeight>b.clientHeight||b.scrollWidth>b.clientWidth},getScroll:function(a){var b,c,d=Box.getDom(a),e=document,f=e.body,g=e.documentElement;return d===e||d===f?(b=g.scrollLeft||(f?f.scrollLeft:0),c=g.scrollTop||(f?f.scrollTop:0)):(b=d.scrollLeft,c=d.scrollTop),{left:b,top:c}},getScrollLeft:function(a){var b=Box.getDom(a),c=document;return b===c||b===c.body?this.getScroll().left:b.scrollLeft},getScrollTop:function(a){var b=Box.getDom(a),c=document;return b===c||b===c.body?this.getScroll().top:b.scrollTop},setScrollLeft:function(a,b){var c=Box.getDom(a);return c.scrollLeft=this.normalizeScrollLeft(b),this},setScrollTop:function(a,b){var c=Box.getDom(a);return c.scrollTop=b,this},normalizeScrollLeft:Box.identityFn}},function(){function a(a,b,c){Box.Array.forEach(c,function(c){a[c]=Box.Function.bind(b[c],Box.Element)})}Box.Element=Box.dom.Element,a(Box,Box.Element,["id","get","getDom","getDoc","getBody","getHead"])});
Box.define("Box.dom.Helper",function(){function a(){var a=a()?document.createRange():!1;return a&&!!a.createContextualFragment}var b="afterbegin",c="afterend",d="beforebegin",e="beforeend",f=["BeforeBegin","previousSibling"],g=["AfterEnd","nextSibling"],h={beforebegin:f,afterend:g},i={beforebegin:f,afterend:g,afterbegin:["AfterBegin","firstChild"],beforeend:["BeforeEnd","lastChild"]};return{singleton:!0,alternateClassName:["Box.DomHelper","Box.dom.DomHelper"],emptyTags:/^(?:br|frame|hr|img|input|link|meta|range|spacer|wbr|area|param|col)$/i,confRe:/^(?:tag|children|cn|html|tpl|tplData)$/i,endRe:/end/i,attributeTransform:{cls:"class",htmlFor:"for"},closeTags:{},detachedDiv:document.createElement("div"),decamelizeName:function(){function a(a,b,c){return b+"-"+c.toLowerCase()}var b=/([a-z])([A-Z])/g,c={};return function(d){return c[d]||(c[d]=d.replace(b,a))}}(),generateMarkup:function(a,b){var c,d,e,f,g,h=this,i=typeof a;if("string"===i||"number"===i)b.push(a);else if(Box.isArray(a))for(f=0;f<a.length;f++)a[f]&&h.generateMarkup(a[f],b);else{e=a.tag||"div",b.push("<",e);for(c in a)a.hasOwnProperty(c)&&(d=a[c],void 0===d||h.confRe.test(c)||("object"==typeof d?(b.push(" ",c,'="'),h.generateStyles(d,b,!0).push('"')):b.push(" ",h.attributeTransform[c]||c,'="',d,'"')));h.emptyTags.test(e)?b.push("/>"):(b.push(">"),(d=a.tpl)&&d.applyOut(a.tplData,b),(d=a.html)&&b.push(d),(d=a.cn||a.children)&&h.generateMarkup(d,b),g=h.closeTags,b.push(g[e]||(g[e]="</"+e+">")))}return b},generateStyles:function(a,b,c){var d,e,f=b||[];for(d in a)a.hasOwnProperty(d)&&(e=a[d],d=this.decamelizeName(d),c&&Box.String.hasHtmlCharacters(e)&&(e=Box.String.htmlEncode(e)),f.push(d,":",e,";"));return b||f.join("")},markup:function(a){if("string"==typeof a)return a;var b=this.generateMarkup(a,[]);return b.join("")},createContextualFragment:function(a){var b,c,d=this.detachedDiv,e=document.createDocumentFragment();for(d.innerHTML=a,c=d.childNodes,b=c.length;b--;)e.appendChild(c[0]);return e},createDom:function(a){var b=this,c=b.markup(a),d=b.detachedDiv;return d.innerHTML=c,d.firstChild},insertHtml:function(f,g,j){var k,l,m,n,o,p=this;if(f=f.toLowerCase(),!g.insertAdjacentHTML){if(3===g.nodeType&&(f=f===b?d:f,f=f===e?c:f),l=a()?g.ownerDocument.createRange():void 0,n="setStart"+(this.endRe.test(f)?"After":"Before"),h[f])return l?(l[n](g),o=l.createContextualFragment(j)):o=this.createContextualFragment(j),g.parentNode.insertBefore(o,f===d?g:g.nextSibling),g[(f===d?"previous":"next")+"Sibling"];if(m=(f===b?"first":"last")+"Child",g.firstChild){if(l)try{l[n](g[m]),o=l.createContextualFragment(j)}catch(q){o=this.createContextualFragment(j)}else o=this.createContextualFragment(j);f===b?g.insertBefore(o,g.firstChild):g.appendChild(o)}else g.innerHTML=j;return g[m]}return p.ieInsertHtml&&(o=p.ieInsertHtml(f,g,j))?o:(k=i[f])?(g.insertAdjacentHTML(k[0],j),g[k[1]]):void Box.Error({className:"Box.dom.Helper",methodName:"insertHtml",error:'Illegal insertion point reached: "'+f+'"'})},before:function(a,b,c){return this.doInsert(a,b,c,d)},after:function(a,b,d){return this.doInsert(a,b,d,c)},append:function(a,b,c){return this.doInsert(a,b,c,e)},prepend:function(a,c,d){return this.doInsert(a,c,d,b)},overwrite:function(a,b,c){var d,e=this;return a=Box.get(a)[0],b=e.markup(b),e.ieOverwrite&&(d=e.ieOverwrite(a,b)),d||(a.innerHTML=b,d=a.firstChild),c?Box.get(d):d},doInsert:function(a,f,g,i){var j,k=this;return a=Box.get(a)[0],"innerHTML"in a?j=k.insertHtml(i,a,k.markup(f)):(j=k.createDom(f,null),3===a.nodeType&&(i=i===b?d:i,i=i===e?c:i),h[i]?a.parentNode.insertBefore(j,i===d?a:a.nextSibling):a.firstChild&&i===b?a.insertBefore(j,a.firstChild):a.appendChild(j)),g?Box.get(j):j},createTemplate:function(a){return new Box.tpl.Base(this.markup(a))},createHtml:function(a){return this.markup(a)},parse:function(a){return this.createHtml(a)}}});
Box.define("Box.util.Event",{constructor:function(a){Box.apply(this,a||{}),this.__$listeners={},this.__$eventsSuspended=0,this.initListeners()},initListeners:function(){var a=this.listeners;this.hasListeners={},Box.Object.each(a,function(a,b){this.hasListeners[a]=!0,this.on(a,b)},this)},on:function(a,b,c){var d,e;if(!b)return this;for(a=a.split(/\s+/);d=a.shift();)e=this.__$listeners[d]||(this.__$listeners[d]=[]),e.push(b,c);return this},once:function(a,b,c){var d=this,e=function(){d.off(a,e),b.apply(c||d,arguments)};return this.on(a,e,c)},off:function(a,b,c){var d,e,f;if(!(a||b||c))return this.__$listeners={},this;for(a=a?a.split(/\s+/):Box.Object.getKeys(this.__$listeners);d=a.shift();)if(e=this.__$listeners[d])if(b||c)for(f=e.length-2;f>=0;f-=2)b&&e[f]!==b||c&&e[f+1]!==c||e.splice(f,2);else delete this.__$listeners[d];return this},trigger:function(a){var b,c,d,e,f,g=[],h=!0;for(a=a.split(/\s+/),e=1,f=arguments.length;f>e;e++)g[e-1]=arguments[e];for(;b=a.shift();)(c=this.__$listeners.all)&&(c=c.slice()),(d=this.__$listeners[b])&&(d=d.slice()),"all"!==b&&(h=this.__$continueFireEvent(d,g)&&h),h=this.__$continueFireEvent(c,[b].concat(g))&&h;return h},suspendEvents:function(){this.__$eventsSuspended+=1,this.__$eventQueue=[]},resumeEvents:function(){var a,b,c=this,d=c.__$eventQueue;if(c.__$eventsSuspended&&!--c.__$eventsSuspended&&(delete c.__$eventQueue,d))for(a=d.length,b=0;a>b;b++)c.__$continueFireEvent.apply(c,d[b])},__$continueFireEvent:function(a,b){var c=!0;if(this.__$eventsSuspended)return this.__$eventQueue&&this.__$eventQueue.push([a,b]),c;if(Box.isEmpty(a))return c;for(var d=0,e=a.length;e>d;d+=2)c=a[d].apply(a[d+1]||this,b)!==!1&&c;return c}});
Box.define("Box.util.Sorter",{mixins:{event:Box.util.Event},property:null,sorterFn:null,root:null,transform:null,direction:"ASC",constructor:function(a){Box.apply(this,a),Box.isEmpty(this.property)&&Box.isEmpty(this.sorterFn)&&Box.Error("A Sorter requires either a property or a sorter function"),this.mixins.event.constructor.call(this,a),this.updateSortFunction()},createSortFunction:function(a){var b=this,c=(b.property,b.direction||"ASC"),d="DESC"==c.toUpperCase()?-1:1;return function(c,e){return d*a.call(b,c,e)}},defaultSorterFn:function(a,b){var c=this,d=c.transform,e=c.getRoot(a)[c.property],f=c.getRoot(b)[c.property];return d&&(e=d(e),f=d(f)),e>f?1:f>e?-1:0},getRoot:function(a){return Box.isEmpty(this.root)?a:a[this.root]},setDirection:function(a){var b=this;b.direction=a?a.toUpperCase():a,b.updateSortFunction()},toggle:function(){var a=this;a.direction=Box.String.toggle(a.direction,"ASC","DESC"),a.updateSortFunction()},updateSortFunction:function(a){var b=this;a=a||b.sorterFn||b.defaultSorterFn,b.sort=b.createSortFunction(a)}});
Box.define("Box.util.Sortable",{isSortable:!0,defaultSortDirection:"ASC",requires:[Box.util.Sorter,Box.util.AbstractMixedCollection],sortRoot:null,initSortable:function(){var a=this.sorters;this.sorters=new Box.util.AbstractMixedCollection(!1,function(a){return a.id||a.property}),a&&this.sorters.addAll(this.decodeSorters(a))},sort:function(a,b,c,d){var e,f,g=this;return Box.isArray(a)?(d=c,c=b,f=a):Box.isObject(a)?(d=c,c=b,f=[a]):Box.isString(a)&&(e=g.sorters.get(a),e?void 0===b?e.toggle():e.setDirection(b):(e={property:a,direction:b},f=[e])),f&&f.length&&(f=g.decodeSorters(f),Box.isString(c)?"prepend"===c?(a=g.sorters.clone().items,g.sorters.clear(),g.sorters.addAll(f),g.sorters.addAll(a)):g.sorters.addAll(f):(g.sorters.clear(),g.sorters.addAll(f))),d!==!1&&(g.onBeforeSort(f),a=g.sorters.items,a.length&&g.doSort(g.generateComparator())),a},generateComparator:function(){var a=this.sorters.getRange();return a.length?this.createComparator(a):this.emptyComparator},createComparator:function(a){return function(b,c){for(var d=a[0].sort(b,c),e=a.length,f=1;e>f;f++)d=d||a[f].sort.call(this,b,c);return d}},emptyComparator:function(){return 0},onBeforeSort:Box.emptyFn,decodeSorters:function(a){Box.isArray(a)||(a=void 0===a?[]:[a]);var b,c,d=a.length,e=Box.util.Sorter;for(c=0;d>c;c++)b=a[c],b instanceof e||(Box.isString(b)&&(b={property:b}),Box.applyIf(b,{root:this.sortRoot,direction:"ASC"}),b.fn&&(b.sorterFn=b.fn),"function"==typeof b&&(b={sorterFn:b}),a[c]=new Box.util.Sorter(b));return a},getSorters:function(){return this.sorters.items},getFirstSorter:function(){for(var a,b=this.sorters.items,c=b.length,d=0;c>d;++d)return a=b[d];return null}});
Box.define("Box.util.Filter",{mixins:{event:Box.util.Event},statics:{createFilterFn:function(a){return a&&a.length?function(b){var c,d,e=!0,f=a.length;for(c=0;e&&f>c;c++)d=a[c],d.disabled||(e=e&&d.filterFn.call(d.scope||d,b));return e}:function(){return!0}}},anyMatch:!1,exactMatch:!1,caseSensitive:!1,root:null,filterFn:null,property:null,value:null,operator:null,operatorFns:{"<":function(a){return Box.coerce(this.getRoot(a)[this.property],this.value)<this.value},"<=":function(a){return Box.coerce(this.getRoot(a)[this.property],this.value)<=this.value},"=":function(a){return Box.coerce(this.getRoot(a)[this.property],this.value)==this.value},"==":function(a){return Box.coerce(this.getRoot(a)[this.property],this.value)==this.value},">=":function(a){return Box.coerce(this.getRoot(a)[this.property],this.value)>=this.value},">":function(a){return Box.coerce(this.getRoot(a)[this.property],this.value)>this.value},"!=":function(a){return Box.coerce(this.getRoot(a)[this.property],this.value)!=this.value}},constructor:function(a){this.initialConfig=a,Box.apply(this,a),this.mixins.event.constructor.call(this,a),this.filter=this.filter||this.filterFn,Box.isEmpty(this.filter)&&this.setValue(a.value)},setValue:function(a){this.value=a,void 0===this.property||void 0===this.value||(this.filter=this.createFilterFn()),this.filterFn=this.filter},setFilterFn:function(a){this.filterFn=this.filter=a},createFilterFn:function(){var a=this,b=this._createValueMatcher(),c=this.property;return this.operator?this.operatorFns[this.operator]:function(d){var e=a.getRoot.call(a,d)[c];return null===b?null===e:b.test(e)}},getRoot:function(a){var b=this.root;return Box.isEmpty(b)?a:a[b]},_createValueMatcher:function(){var a=this.value,b=this.anyMatch,c=this.exactMatch,d=this.caseSensitive,e=Box.String.escapeRegex;return null===a?a:(a.exec||(a=String(a),b===!0?a=e(a):(a="^"+e(a),c===!0&&(a+="$")),a=new RegExp(a,d?"":"i")),a)},serialize:function(){var a=Box.apply({},this.initialConfig);return a.value=this.value,a}});
Box.define("Box.util.AbstractMixedCollection",{requires:[Box.util.Filter],mixins:{event:Box.util.Event},isMixedCollection:!0,generation:0,constructor:function(a){Box.isObject(a)?Box.apply(this,a):Box.isFunction(a)&&(this.getKey=a),this.mixins.event.constructor.call(this),this.items=[],this.map={},this.keys=[],this.length=0},getKey:function(a){return a.id},add:function(a,b){var c,d=a,e=b;if(1==arguments.length&&(e=d,d=this.getKey(e)),"undefined"!=typeof d&&null!==d){if(c=this.map[d],"undefined"!=typeof c)return this.replace(d,e);this.map[d]=e}return this.generation++,this.length++,this.items.push(e),this.keys.push(d),this.trigger("add",this.length-1,e,d),e},addAll:function(a){var b,c,d,e=0;if(arguments.length>1||Box.isArray(a))for(b=arguments.length>1?arguments:a,c=b.length;c>e;e++)this.add(b[e]);else for(d in a)a.hasOwnProperty(d)&&this.add(d,a[d])},replace:function(a,b){var c,d;return 1==arguments.length&&(b=arguments[0],a=this.getKey(b)),c=this.map[a],"undefined"==typeof a||null===a||"undefined"==typeof c?this.add(a,b):(this.generation++,d=this.indexOfKey(a),this.items[d]=b,this.map[a]=b,this.trigger("replace",a,c,b),b)},each:function(a,b){for(var c,d=[].concat(this.items),e=d.length,f=0;e>f&&(c=d[f],a.call(b||c,c,f,e)!==!1);f++);},eachKey:function(a,b){for(var c=this.keys,d=this.items,e=c.length,f=0;e>f;f++)a.call(b||window,c[f],d[f],f,e)},findBy:function(a,b){for(var c=this.keys,d=this.items,e=d.length,f=0;e>f;f++)if(a.call(b||window,d[f],c[f]))return d[f];return null},find:function(){return this.findBy.apply(this,arguments)},insert:function(a,b,c){var d=b,e=c;return 2==arguments.length&&(e=c,d=this.getKey(e)),this.containsKey(d)&&(this.suspendEvents(),this.removeAtKey(d),this.resumeEvents()),a>=this.length?this.add(d,e):(this.generation++,this.length++,Box.Array.splice(this.items,a,0,e),"undefined"!=typeof d&&null!==d&&(this.map[d]=e),Box.Array.splice(this.keys,a,0,e),this.trigger("add",a,e,d),e)},remove:function(a){return this.generation++,this.removeAt(this.indexOf(a))},removeAt:function(a){var b,c;return a<this.length&&a>=0?(this.length--,c=this.items[a],Box.Array.erase(this.items,a,1),b=this.keys[a],"undefined"!=typeof b&&delete this.map[b],Box.Array.erase(this.keys,a,1),this.trigger("remove",c,b),this.generation++,c):!1},removes:function(a){a=[].concat(a);var b,c=a.length;for(b=0;c>b;b++)this.remove(a[b]);return this},removeAtKey:function(a){return this.removeAt(this.indexOfKey(a))},getCount:function(){return this.length},indexOf:function(a){return Box.Array.indexOf(this.items,a)},indexOfKey:function(a){return Box.Array.indexOf(this.keys,a)},get:function(a){var b=this.map[a],c=void 0!==b?b:"number"==typeof a?this.items[a]:void 0;return"function"!=typeof c?c:null},getAt:function(a){return this.items[a]},getByKey:function(a){return this.map[a]},contains:function(a){return"undefined"!=typeof this.map[this.getKey(a)]},containsKey:function(a){return"undefined"!=typeof this.map[a]},clear:function(){this.length=0,this.items=[],this.keys=[],this.map={},this.generation++,this.trigger("clear")},first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},sum:function(a,b,c,d){var e,f=this._extractValues(a,b),g=f.length,h=0;for(c=c||0,d=d||0===d?d:g-1,e=c;d>=e;e++)h+=f[e];return h},_extractValues:function(a,b){var c=this.items;return b&&(c=Box.Array.pluck(c,b)),Box.Array.pluck(c,a)},collect:function(a,b,c,d){var e,f,g,h=this._extractValues(a,b),i=h.length,j={},k=[];for(g=0;i>g;g++)e=h[g],f=String(e),(d||!Box.isEmpty(e))&&(c?j[f]||(j[f]=!0,k.push(e)):k.push(e));return k},getRange:function(a,b){var c,d=this.items,e=[];if(d.length<1)return e;if(a=a||0,b=Math.min("undefined"==typeof b?this.length-1:b,this.length-1),b>=a)for(c=a;b>=c;c++)e[e.length]=d[c];else for(c=a;c>=b;c--)e[e.length]=d[c];return e},filter:function(a,b,c,d){var e,f=[];return Box.isString(a)?f.push(new Box.util.Filter({property:a,value:b,anyMatch:c,caseSensitive:d})):(Box.isArray(a)||a instanceof Box.util.Filter)&&(f=f.concat(a)),e=function(a){var b,c,d,e,g=!0,h=f.length;for(e=0;h>e;e++)b=f[e],d=b.filterFn,c=b.scope,g=g&&d.call(c,a);return g},this.filterBy(e)},filterBy:function(a,b){var c,d=new this.self,e=this.keys,f=this.items,g=f.length;for(d.getKey=this.getKey,c=0;g>c;c++)a.call(b||this,f[c],e[c])&&d.add(e[c],f[c]);return d},findIndex:function(a,b,c,d,e){return Box.isEmpty(b,!1)?-1:(b=this._createValueMatcher(b,d,e),this.findIndexBy(function(c){return c&&b.test(c[a])},null,c))},findIndexBy:function(a,b,c){for(var d=this.keys,e=this.items,f=e.length,g=c||0;f>g;g++)if(a.call(b||this,e[g],d[g]))return g;return-1},_createValueMatcher:function(a,b,c,d){if(!a.exec){var e=Box.String.escapeRegex;a=String(a),b===!0?a=e(a):(a="^"+e(a),d===!0&&(a+="$")),a=new RegExp(a,c?"":"i")}return a},clone:function(){for(var a=new this.self,b=this.keys,c=this.items,d=c.length,e=0;d>e;e++)a.add(b[e],c[e]);return a.getKey=this.getKey,a}});
Box.define("Box.util.MixedCollection",{requires:[Box.util.Filter],mixins:{sortable:Box.util.Sortable},extend:Box.util.AbstractMixedCollection,constructor:function(){this.callParent(arguments),this.initSortable()},doSort:function(a){this.sortBy(a)},_sort:function(a,b,c){var d,e,f="DESC"==String(b).toUpperCase()?-1:1,g=this.keys,h=this.items,i=[];for(c=c||function(a,b){return a-b},d=0,e=h.length;e>d;d++)i[i.length]={key:g[d],value:h[d],index:d};for(Box.Array.sort(i,function(b,d){var e=c(b[a],d[a])*f;return 0===e&&(e=b.index<d.index?-1:1),e}),d=0,e=i.length;e>d;d++)h[d]=i[d].value,g[d]=i[d].key;this.trigger("sort",this)},sortBy:function(a,b){var c,d=this.items,e=this.keys,f=d.length,g=[];for(c=0;f>c;c++)g[c]={key:e[c],value:d[c],index:c};for(Box.Array.sort(g,function(c,d){var e=a.call(b||this,c.value,d.value);return 0===e&&(e=c.index<d.index?-1:1),e},this),c=0;f>c;c++)d[c]=g[c].value,e[c]=g[c].key;this.trigger("sort",this,d,e)},findInsertionIndex:function(a,b){var c,d,e=this.items,f=0,g=e.length-1;for(b||(b=this.generateComparator());g>=f;)c=f+g>>1,d=b(a,e[c]),d>=0?f=c+1:0>d&&(g=c-1);return f},reorder:function(a){var b,c=this.items,d=0,e=c.length,f=[],g=[];for(b in a)f[a[b]]=c[b];for(d=0;e>d;d++)void 0==a[d]&&g.push(c[d]);for(d=0;e>d;d++)void 0==f[d]&&(f[d]=g.shift());this.clear(),this.addAll(f),this.trigger("sort",this)},sortByKey:function(a,b,c){Box.isFunction(a)&&(b=a,a="ASC"),this._sort("key",a,Box.Function.bind(b||function(a,b){var c=String(a).toUpperCase(),d=String(b).toUpperCase();return c>d?1:d>c?-1:0},c||this))}});
Box.define("Box.util.Cookie",{singleton:!0,set:function(a,b){var c=arguments,d=arguments.length,e=d>2?c[2]:null,f=d>3?c[3]:"/",g=d>4?c[4]:null,h=d>5?c[5]:!1,i=a+"="+escape(b);null!==e&&(i+="; expires="+e.toGMTString()),null!==f&&(i+="; path="+f),null!==g&&(i+="; domain="+g),h===!0&&(i+="; secure"),document.cookie=i},get:function(a){for(var b=a+"=",c=b.length,d=document.cookie.length,e=0,f=0;d>e;){if(f=e+c,document.cookie.substring(e,f)==b)return this.getCookieVal(f);if(e=document.cookie.indexOf(" ",e)+1,0===e)break}return null},clear:function(a,b){this.get(a)&&(b=b||"/",document.cookie=a+"=; expires=Thu, 01-Jan-70 00:00:01 GMT; path="+b)},getCookieVal:function(a){var b=document.cookie.indexOf(";",a);return-1==b&&(b=document.cookie.length),unescape(document.cookie.substring(a,b))}});
Box.define("Box.util.JSON",{singleton:!0,encodingFunction:null,decodingFunction:null,useNative:null,useHasOwn:!!{}.hasOwnProperty,specials:{"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\","":"\\u000b"},charToReplace:/[\\\"\x00-\x1f\x7f-\uffff]/g,isNative:function(){return Box.USE_NATIVE_JSON&&window.JSON&&"[object JSON]"==JSON.toString()},pad:function(a){return 10>a?"0"+a:a},doDecode:function(json){return eval("("+json+")")},doEncode:function(a,b){return null===a||void 0===a?"null":Box.isDate(a)?this.encodeDate(a):Box.isString(a)?this.encodeString(a):"number"==typeof a?isFinite(a)?String(a):"null":Box.isBoolean(a)?String(a):a.toJSON?a.toJSON():Box.isArray(a)?this.encodeArray(a,b):Box.isObject(a)?this.encodeObject(a,b):"function"==typeof a?"null":"undefined"},encodeString:function(a){return'"'+a.replace(this.charToReplace,function(a){var b=this.specials[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"'},encodeArrayPretty:function(a,b){var c,d=a.length,e=b+"   ",f=","+e,g=["[",e];for(c=0;d>c;c+=1)g.push(this.encodeValue(a[c],e),f);return g[g.length-1]=b+"]",g.join("")},encodeObjectPretty:function(a,b){var c,d=b+"   ",e=","+d,f=["{",d];for(c in a)(!this.useHasOwn||a.hasOwnProperty(c))&&f.push(this.encodeValue(c)+": "+this.encodeValue(a[c],d),e);return f[f.length-1]=b+"}",f.join("")},encodeArray:function(a,b){if(b)return this.encodeArrayPretty(a,b);var c,d=["[",""],e=a.length;for(c=0;e>c;c+=1)d.push(this.encodeValue(a[c]),",");return d[d.length-1]="]",d.join("")},encodeObject:function(a,b){if(b)return this.encodeObjectPretty(a,b);var c,d=["{",""];for(c in a)(!this.useHasOwn||a.hasOwnProperty(c))&&d.push(this.encodeValue(c),":",this.encodeValue(a[c]),",");return d[d.length-1]="}",d.join("")},encodeDate:function(a){return'"'+a.getFullYear()+"-"+this.pad(a.getMonth()+1)+"-"+this.pad(a.getDate())+"T"+this.pad(a.getHours())+":"+this.pad(a.getMinutes())+":"+this.pad(a.getSeconds())+'"'},encode:function(a){return this.encodingFunction||(this.encodingFunction=this.isNative()?JSON.stringify:this.doEncode),this.encodingFunction(a)},decode:function(a,b){this.decodingFunction||(this.decodingFunction=this.isNative()?JSON.parse:this.doDecode);try{return this.decodingFunction(a)}catch(c){if(b===!0)return null;Box.Error({className:"Box.util.JSON",methodName:"decode",error:"You're trying to decode an invalid JSON String: "+a})}}},function(){Box.JSON=Box.util.JSON,Box.JSON.encodeValue=Box.JSON.doEncode});
Box.define("Box.util.Format",function(){var a,b=/<\/?[^>]+>/gi,c=/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/gi,d=/\r?\n/g,e=/[^\d\.]/g;return{singleton:!0,thousandSeparator:",",decimalSeparator:".",currencyPrecision:2,currencySign:"$",currencyAtEnd:!1,undef:function(a){return void 0!==a?a:""},defaultValue:function(a,b){return void 0!==a&&""!==a?a:b},substr:"b"!="ab".substr(-1)?function(a,b,c){var d=String(a);return 0>b?d.substr(Math.max(d.length+b,0),c):d.substr(b,c)}:function(a,b,c){return String(a).substr(b,c)},lowercase:function(a){return String(a).toLowerCase()},uppercase:function(a){return String(a).toUpperCase()},usMoney:function(a){return this.currency(a,"$",2)},currency:function(a,b,c,d){var e="",f=",0",g=0;for(a-=0,0>a&&(a=-a,e="-"),c=c||_module.currencyPrecision,f+=f+(c>0?".":"");c>g;g++)f+="0";return a=this.number(a,f),(d||this.currencyAtEnd)===!0?Box.String.format("{0}{1}{2}",e,a,b||this.currencySign):Box.String.format("{0}{1}{2}",e,b||this.currencySign,a)},date:function(a,b){return a?(Box.isDate(a)||(a=new Date(Date.parse(a))),Box.Date.format(a,b||Box.Date.defaultFormat)):""},dateRenderer:function(a){return function(b){return Box.Date.format(b,a)}},stripTags:function(a){return a?String(a).replace(b,""):a},stripScripts:function(a){return a?String(a).replace(c,""):a},fileSize:function(a){return 1024>a?a+" bytes":1048576>a?Math.round(10*a/1024)/10+" KB":Math.round(10*a/1048576)/10+" MB"},math:function(){var a={};return function(b,c){return a[c]||(a[c]=Box.functionFactory("v","return v "+c+";")),a[c](b)}}(),round:function(a,b){var c=Number(a);return"number"==typeof b&&(b=Math.pow(10,b),c=Math.round(a*b)/b),c},number:function(b,c){if(!c)return b;if(b=Box.Number.num(b,0/0),isNaN(b))return"";var d,f,g=this.thousandSeparator,h=this.decimalSeparator,i=!1,j=0>b;if(b=Math.abs(b),"/i"==c.substr(c.length-2)?(a||(a=new RegExp("[^\\d\\"+this.decimalSeparator+"]","g")),c=c.substr(0,c.length-2),i=!0,d=-1!=c.indexOf(g),f=c.replace(a).split(h)):(d=-1!=c.indexOf(","),f=c.replace(e,"").split(".")),1<f.length)b=b.toFixed(f[1].length);else{if(2<f.length)return void alert("Invalid number format, should have no more than 1 decimal");b=b.toFixed(0)}var k=b.toString();if(f=k.split("."),d){var l,m=f[0],n=[],o=m.length,p=Math.floor(o/3),q=m.length%3||3;for(l=0;o>l;l+=q)0!==l&&(q=3),n[n.length]=m.substr(l,q),p-=1;k=n.join(g),f[1]&&(k+=h+f[1])}else f[1]&&(k=f[0]+h+f[1]);return(j?"-":"")+c.replace(/[\d,?\.?]+/,k)},numberRenderer:function(a){return function(b){return this.number(b,a)}},plural:function(a,b,c){return a+" "+(1==a?b:c?c:b+"s")},nl2br:function(a){return Box.isEmpty(a)?"":a.replace(d,"<br/>")},firstUpperCase:Box.String.firstUpperCase,ellipsis:Box.String.ellipsis,format:Box.String.format,htmlDecode:Box.String.htmlDecode,htmlEncode:Box.String.htmlEncode,leftPad:Box.String.leftPad,trim:Box.String.trim,escapeRegex:function(a){return a.replace(/([\-.*+?\^${}()|\[\]\/\\])/g,"\\$1")},parseBox:function(a){if(a=a||0,Box.isObject(a))return{top:a.top||0,right:a.right||0,bottom:a.bottom||0,left:a.left||0,width:(a.right||0)+(a.left||0),height:(a.top||0)+(a.bottom||0)};"string"!=typeof a&&(a=a.toString());var b=a.split(/\s+/),c=b.length;return 1==c?b[1]=b[2]=b[3]=b[0]:2==c?(b[2]=b[0],b[3]=b[1]):3==c&&(b[3]=b[1]),{top:parseFloat(b[0])||0,right:parseFloat(b[1])||0,bottom:parseFloat(b[2])||0,left:parseFloat(b[3])||0,width:(parseFloat(b[1])||0)+(parseFloat(b[3])||0),height:(parseFloat(b[0])||0)+(parseFloat(b[2])||0)}}}}());
Box.define("Box.util.RegExp",{statics:{create:function(){return new Box.util.RegExp},is:function(a,b){var c=Box.util.RegExp[a];return Box.isFunction(c)||Box.Error("can not find "+a+" method"),c().test(b)},ip:function(){var a=Box.regexp().beginCapture().number().repeat(1,2).or().then("1").number().repeat(2).or().then("2").range("0","4").number().or().then("25").range("0","5").endCapture();return Box.regexp().startOfLine().beginCapture().then(a).then(".").endCapture().repeat(3).then(a).endOfLine()},url:function(){return Box.regexp().startOfLine().then("http").maybe("s").then("://").maybe("www.").anythingBut(" ").endOfLine()},image:function(){return Box.regexp().startOfLine().word().then(".").orBy("jpg","jfif","jpeg","tiff","raw","pam","webp","svg","pns","mpo","jps","png","gif","bmp").endOfLine()},email:function(){return Box.regexp().startOfLine().word().beginCapture().then(".").word().endCapture().add("*").then("@").word().beginCapture().then(".").word().endCapture().add("+").endOfLine()}},isRegExp:!0,prefixes:"",suffixes:"",source:"",modifiers:"gm",sanitize:function(a){return a.source?a.source:Box.isNumber(a)?a:a.replace(/[^\w]/g,function(a){return"\\"+a})},add:function(a){return this.source+=a||"",this.expression=this.expression||new RegExp,this.expression.compile(this.prefixes+this.source+this.suffixes,this.modifiers),this},reset:function(){return this.add(Box.EMPTY_STRING)},startOfLine:function(a){return a=a!==!1,this.prefixes=a?"^":"",this.reset()},endOfLine:function(a){return a=a!==!1,this.suffixes=a?"$":"",this.reset()},then:function(a){return a=this.sanitize(a),this.add("(?:"+a+")")},find:function(a){return this.then(a)},maybe:function(a){return a=this.sanitize(a),this.add("(?:"+a+")?")},anything:function(){return this.add("(?:.*)")},anythingBut:function(a){return a=this.sanitize(a),this.add("(?:[^"+a+"]*)")},something:function(){return this.add("(?:.+)")},somethingBut:function(a){return a=this.sanitize(a),this.add("(?:[^"+a+"]+)")},lineBreak:function(){return this.add("(?:\\r\\n|\\r|\\n)")},br:function(){return this.lineBreak()},word:function(){return this.add("(?:\\w+)")},tab:function(){return this.add("(?:\\t)")},whitespace:function(){return this.add("(?:\\s)")},number:function(){return this.add("(?:\\d)")},any:function(a){return a=this.sanitize(a),this.add("["+a+"]")},range:function(){for(var a="[",b=1;b<arguments.length;b+=2){var c=this.sanitize(arguments[b-1]),d=this.sanitize(arguments[b]);a+=c+"-"+d}return a+="]",this.add(a)},repeat:function(){var a,b=arguments.length;if((0==b||b>2)&&Box.Error("arguments’s length must gt 0 and lt 3"),1==arguments.length)a="{"+Box.num(arguments[0])+"}";else{for(var c=[],d=0;d<arguments.length;d++)c.push(Box.num(arguments[d]));a="{"+c.join(",")+"}"}return this.add(a||"")},multiple:function(a){return a=a.source?a.source:this.sanitize(a),1===arguments.length&&this.add("(?:"+a+")*"),2==arguments.length&&(this.add("(?:"+a+")"),this.add("{"+arguments[1]+"}")),this},or:function(a){return this.prefixes+="(?:",this.suffixes=")"+this.suffixes,this.add(")|(?:"),a&&this.then(a),this},orBy:function(){var a=Box.Array.toArray(arguments);return a=Box.Array.map(a,function(a){return a.source?"(?:"+a.source+")":this.sanitize(a)},this),this.add("(?:"+a.join("|")+")")},beginCapture:function(){return this.suffixes+=")",this.add("(",!1)},endCapture:function(){return this.suffixes=this.suffixes.substring(0,this.suffixes.length-1),this.add(")",!0)},setModifier:function(a){return this.modifiers=a,this.reset()},toRegExp:function(){var a=this.expression.toString().match(/\/(.*)\/([a-z]+)?/);return new RegExp(a[1],a[2])},replace:function(a,b){return a=a.toString(),a.replace(this.expression,b)},exec:function(a){return this.expression.exec(a)},test:function(a){return this.expression.test(a)}},function(){Box.RegExp=Box.util.RegExp,Box.regexp=Box.util.RegExp.create});
Box.define("Box.util.HashMap",{mixins:{event:Box.util.Event},isHashMap:!0,constructor:function(a){this.initialConfig=a,Box.isObject(a)?Box.apply(this,a||{}):Box.isFunction(a)&&(this.getKey=a),this.mixins.event.constructor.call(this,a),this.clear(!0)},len:function(){return this.length},getCount:function(){return this.len()},data:function(a,b){return void 0===b&&(b=a,a=this.getKey(b)),[a,b]},getData:function(a,b){return this.data(a,b)},getKey:function(a){return a.id},push:function(a,b){if(Box.isArray(a))return Box.Array.forEach(a,function(a){this.push(a)},this),this;var c;return 1===arguments.length&&(b=a,a=this.getKey(b)),this.indexOf(a)?this.replace(a,b):++this.length,c=this.data(a,b),a=c[0],b=c[1],this.map[a]=b,this.trigger("add",this,a,b),b},add:function(a,b){return this.push(a,b)},addAll:function(a){return this.push(a)},get:function(a){return this.map[a]},remove:function(a,b){if(!b){var c=this.findKey(a);return void 0!==c?this.removeAtKey(c):!1}return this.removeAtKey(a)},removeAtKey:function(a){if(this.containsKey(a)){var b=this.map[a];return delete this.map[a],--this.length,this.trigger("remove",this,a,b),!0}return!1},containsKey:function(a){return void 0!==this.map[a]},contains:function(a){return this.containsKey(this.findKey(a))},replace:function(a,b){var c;return 1==arguments.length&&(b=a,a=this.getKey(a)),this.containsKey(a)?(c=this.map[a],this.map[a]=b,this.trigger("replace",this,a,b,c),b):(this.add(a,b),b)},findKey:function(a){var b;for(b in this.map)if(this.map.hasOwnProperty(b)&&this.map[b]===a)return b;return void 0},indexOf:function(a){return void 0!==this.map[a]},clear:function(a){return this.map={},this.length=0,a!==!0&&this.trigger("clear",this),this},eq:function(a){var b,c=0;a=a||0;for(b in this.map)if(this.map.hasOwnProperty(b)){if(a==c)return this.map[b];c++}},keys:function(){return this.getArray(!0)},getKeys:function(){return this.keys()},values:function(){return this.getArray()},getValues:function(){return this.values()},getArray:function(a){var b,c=[];for(b in this.map)this.map.hasOwnProperty(b)&&c.push(a?b:this.map[b]);return c},each:function(a,b){var c,d=Box.apply({},this.map),e=this.length,f=0;b=b||this;for(c in d)if(d.hasOwnProperty(c)){if(a.call(b,c,d[c],e,f)===!1)break;f++}return this},clone:function(){var a,b=new this.self(this.initialConfig);for(a in this.map)this.map.hasOwnProperty(a)&&b.push(a,this.map[a]);return b}});
Box.define("Box.util.ListenerProxy",{statics:{create:function(){var a=new Box.util.ListenerProxy,b=Array.prototype.concat.apply([],arguments);if(b.length>0){var c=b[b.length-1],d=b[b.length-2];"function"==typeof c&&"function"==typeof d&&(b.pop(),a.fail(c)),a.all.apply(a,b)}return a}},firedCaches:{},callbackCaches:{},afterCaches:{},all_event_name:"__all__",on:function(a,b){return this.callbackCaches[a]=this.callbackCaches[a]||[],this.callbackCaches[a].push(b),this},headOn:function(a,b){return this.callbackCaches[a]=this.callbackCaches[a]||[],this.callbackCaches[a].unshift(b),this},_on_all:function(a){this.on(this.all_event_name,a)},off:function(a,b){var c=this.callbackCaches;if(Box.isEmpty(a))this.callbackCaches={};else if(Box.isEmpty(b))c[a]=[];else{var d=c[a];if(d)for(var e=d.length,f=0;e>f;f++)d[f]=null}},_off_all:function(a){this.off(this.all_event_name,a)},emit:function(a){for(var b,c,d,e,f,g,h=2;h--;)if(c=h?a:this.all_event_name,b=this.callbackCaches[c],!Box.isEmpty(b))for(f=0,g=b.length;g>f;f++)(d=b[f])?(e=h?Array.prototype.slice.call(arguments,1):arguments,d.apply(this,e)):(b.splice(f,1),f--,g--);return this},once:function(a,b){var c=this,d=function(){b.apply(c,arguments),c.off(a,d)};return this.on(a,d),this},immediate:function(a,b,c){return this.on(a,b),this.emit(a,c),this},_assign:function(){var a=this,b=arguments.length,c=0,d={};if(3>b)return this;var e=Array.prototype.slice.call(arguments,0,-2),f=arguments[b-2],g=arguments[b-1];if("function"!=typeof f)return this;Box.Array.forEach(e,function(a){var b=g?"once":"on";this[b](a,function(b){this.firedCaches[a]=this.firedCaches[a]||{},this.firedCaches[a].data=b,d[a]||(d[a]=!0,c++)})},this);var h=function(b){if(!(c<e.length)&&d[b]){var i=Box.Array.map(e,function(a){return this.firedCaches[a].data},a);g&&a._off_all(h),f.apply(null,i)}};this._on_all(h)},all:function(){var a=Array.prototype.concat.apply([],arguments);return a.push(!0),this._assign.apply(this,a),this},fail:function(a){var b=this;return this.once("error",function(){b.off(),a.apply(null,arguments)}),this},tail:function(){var a=Array.prototype.concat.apply([],arguments);return a.push(!1),this._assign.apply(this,a),this},after:function(a,b,c){if(0===b)return c.call(null,[]),this;var d=this,e=[],f=a+"_group";this.afterCaches=this.afterCaches||{},this.afterCaches[f]={index:0,results:[]};var g=function(h,i){h===a&&(b--,e.push(i),1>b&&(d._off_all(g),c.apply(null,[e]))),h===f&&(b--,d.afterCaches[f].results[i.index]=i.result,1>b&&(d._off_all(g),c.call(null,d.afterCaches[f].results)))};this._on_all(g)},group:function(a,b){var c=this,d=a+"_group",e=this.afterCaches[d].index,f=Array.property.slice;return this.afterCaches[d].index++,function(a,g){return a?c.emit.apply(c,["error"].concat(f.call(arguments))):void c.emit(d,{index:e,result:b?b.apply(null,f.call(arguments,1)):g})}},any:function(){var a=Array.property.slice,b=arguments[arguments.length-1],c=a.call(arguments,0,-1),d=c.join("_"),e=this;this.once(d,b);Box.Array.forEach(c,function(a){this.on(a,function(b){e.emit(d,{data:b,eventName:a})})},this)},not:function(a,b){this._on_all(function(c,d){c!==a&&b(d)})},done:function(a,b){var c=this,d=Array.prototype.slice;return function(e,f){if(e)return c.emit.apply(c,["error"].concat(d.call(arguments)));var g=d.call(arguments,1);return"string"==typeof a?b?c.emit(a,b.apply(null,g)):c.emit.apply(c,[a].concat(g)):arguments.length<=2?a(f):void a.apply(null,g)}}},function(){Box.Array.forEach([{name:"all",alias:["assign"]},{name:"on",alias:["bind","addListener"]},{name:"off",alias:["unbind","removeListener"]},{name:"emit",alias:["trigger","fire"]}],function(a){a.alias=Box.Array.toArray(a.alias),Box.Array.forEach(a.alias,function(b){this.prototype[b]=Box.Function.alias(this.prototype,a.name)},this)},this)});
Box.define("Box.util.LocalStorage",{statics:{ID:+new Date,cache:{},get:function(a){var b,c=this.cache,d={_users:1};return Box.isString(a)?d.id=a:Box.apply(d,a),(b=c[d.id])?(b===!0&&Box.Error('Creating a shared instance of private local store "'+this.id+'".'),++b._users):b=new this(d),b},supported:!0},id:null,destroyed:!1,lazyKeys:!0,prefix:"",session:!1,_keys:null,_store:null,_users:0,constructor:function(a){var b=this.statics();Box.apply(this,a),this.id=this.id||b.ID++,this._users?b.cache[this.id]=this:(b.cache[this.id]&&Box.Error('Cannot create duplicate instance of local store "'+this.id+'". Use Box.util.LocalStorage.get() to share instances.'),b.cache[this.id]=!0),this.initStore()},initStore:function(){!this.prefix&&this.id&&(this.prefix=this.id+"-"),this._store=this.session?Box.global.sessionStorage:Box.global.localStorage},getKeys:function(){var a,b,c=this._store,d=this.prefix,e=this._keys,f=d.length;if(!e)for(this._keys=e=[],b=c.length;b--;)a=c.key(b),a.length>f&&d===a.substring(0,f)&&e.push(a.substring(f));return e},key:function(a){var b=this._keys||this.getKeys();return a>=0&&a<b.length?b[a]:null},release:function(){--this._users||this.destroy()},set:function(a,b){var c=this.prefix+a,d=this._store,e=this._keys,f=d.length;d.setItem(c,b),e&&f!==d.length&&e.push(a)},get:function(a){return this._store.getItem(this.prefix+a)},remove:function(a){var b=this.prefix+a,c=this._store,d=this._keys,e=c.length;c.removeItem(b),d&&e!==c.length&&(this.lazyKeys?this._keys=null:Box.Array.remove(d,a))},clear:function(){var a,b=this._store,c=this.prefix,d=this._keys||this.getKeys();for(a=d.length;a--;)b.removeItem(c+d[a]);d.length=0}},function(){var a=this;if(!("LocalStorage"in window))return Box.browser.is("IE")?void Box.apply(this.prototype,{}):(a.supported=!1,void(a.prototype.init=function(){Box.Error("Local storage is not supported on this browser")}))});
Box.define("Box.util.KeyMap",{alternateClassName:"Box.KeyMap",eventName:"keydown",binding:null,target:null,processEventScope:null,ignoreInputFields:!1,constructor:function(a){return 1!==arguments.length||"string"==typeof a||a.dom||a.tagName||a===document||a.isComponent?void this.legacyConstructor.apply(this,arguments):(Box.apply(this,a),this.bindings=[],this.target.isComponent||(this.target=Box.get(this.target)),this.binding?this.addBinding(this.binding):a.key&&this.addBinding(a),void this.enable())},legacyConstructor:function(a,b,c){Box.apply(this,{target:Box.get(a),eventName:c||this.eventName,bindings:[]}),b&&this.addBinding(b),this.enable()},addBinding:function(a){var b,c,d=a.key,e=this.bindings;if(this.processing&&(this.bindings=e.slice(0)),Box.isArray(a))for(b=0,c=a.length;c>b;b++)this.addBinding(a[b]);else this.bindings.push(Box.apply({keyCode:this.processKeys(d)},a))},removeBinding:function(a){var b,c,d,e=this.bindings,f=e.length;for(this.processing&&(this.bindings=e.slice(0)),b=this.processKeys(a.key),d=0;f>d;++d)if(c=e[d],(c.fn||c.handler)===(a.fn||a.handler)&&c.scope===a.scope&&a.alt===c.alt&&a.crtl===c.crtl&&a.shift===c.shift&&Box.Array.equals(c.keyCode,b))return void Box.Array.erase(this.bindings,d,1)},processKeys:function(a){var b,c,d,e,f,g=!1;if(Box.isString(a)){for(b=[],d=a.toUpperCase(),f=0,e=d.length;e>f;++f)b.push(d.charCodeAt(f));a=b,g=!0}if(Box.isArray(a)||(a=[a]),!g)for(f=0,e=a.length;e>f;++f)c=a[f],Box.isString(c)&&(a[f]=c.toUpperCase().charCodeAt(0));return a},handleTargetEvent:function(){var a=/input|textarea/i;return function(b){var c,d,e,f,g,h=this;if(h.enabled){if(c=h.bindings,d=0,e=c.length,b=h.processEvent.apply(h||h.processEventScope,arguments),h.ignoreInputFields&&(f=b.target,g=f.contentEditable,a.test(f.tagName)||""===g||"true"===g))return;if(Box.isEmpty(b.which))return b;for(h.processing=!0;e>d;++d)h.processBinding(c[d],b);h.processing=!1}}}(),processEvent:Box.identityFn,processBinding:function(a){if(this.checkModifiers(a,event)){var b,c,d=event.which,e=a.fn||a.handler,f=a.scope||this,g=a.keyCode,h=a.defaultEventAction;for(b=0,c=g.length;c>b;++b)if(d===g[b]){e.call(f,d,event)!==!0&&h&&("stopEvent"==h?(event.preventDefault(),event.stopPropagation()):event[h]());break}}},checkModifiers:function(a,b){for(var c,d,e=["shift","ctrl","alt"],f=e.length,g=0;f>g;++g)if(c=e[g],d=a[c],void 0!==d&&d!==b[c+"Key"])return!1;return!0},on:function(a,b,c){var d,e,f,g;Box.isObject(a)&&!Box.isArray(a)?(d=a.key,e=a.shift,f=a.ctrl,g=a.alt):d=a,this.addBinding({key:d,shift:e,ctrl:f,alt:g,fn:b,scope:c})},un:function(a,b,c){var d,e,f,g;Box.isObject(a)&&!Box.isArray(a)?(d=a.key,e=a.shift,f=a.ctrl,g=a.alt):d=a,this.removeBinding({key:d,shift:e,ctrl:f,alt:g,fn:b,scope:c})},isEnabled:function(){return this.enabled},enable:function(){this.enabled||(this.__$handleTargetEvent=Box.Function.bind(this.handleTargetEvent,this),this.target.on(this.eventName,this.__$handleTargetEvent),this.enabled=!0)},disable:function(){this.enabled&&this.__$handleTargetEvent&&(this.target.off(this.eventName,this.__$handleTargetEvent),this.enabled=!1)},setDisabled:function(a){a?this.disable():this.enable()},destroy:function(){this.target;this.bindings=[],this.disable(),delete this.target}});
Box.define("Box.util.KeyNav",{alternateClassName:"Box.KeyNav",requires:[Box.util.KeyMap],disabled:!1,defaultEventAction:"stopEvent",forceKeyDown:!1,eventName:"keypress",processEventScope:null,ignoreInputFields:!1,statics:{keyOptions:{left:37,right:39,up:38,down:40,space:32,pageUp:33,pageDown:34,del:46,backspace:8,home:36,end:35,enter:13,esc:27,tab:9}},constructor:function(a){return 2===arguments.length?void this.legacyConstructor.apply(this,arguments):void this.doConstruction(a)},legacyConstructor:function(a,b){this.doConstruction(Box.apply({target:a},b))},doConstruction:function(a){var b,c=this,d={target:a.target,ignoreInputFields:a.ignoreInputFields,eventName:c.getKeyEvent("forceKeyDown"in a?a.forceKeyDown:c.forceKeyDown,a.eventName),capture:a.capture};c.map&&c.map.destroy(),a.processEvent&&(d.processEvent=a.processEvent,d.processEventScope=a.processEventScope||c),a.keyMap?b=c.map=a.keyMap:(b=c.map=new Box.util.KeyMap(d),c.destroyKeyMap=!0),this.addBindings(a),b.disable(),a.disabled||b.enable()},addBindings:function(a){var b=this,c=b.map,d=Box.util.KeyNav.keyOptions,e=a.scope||b;Box.Object.each(a,function(f,g){!g||1!==f.length&&!(f=d[f])&&isNaN(f=parseInt(f,10))||("function"==typeof g&&(g={handler:g,defaultEventAction:void 0!==a.defaultEventAction?a.defaultEventAction:b.defaultEventAction}),c.addBinding({key:f,ctrl:g.ctrl,shift:g.shift,alt:g.alt,handler:Box.Function.bind(b.handleEvent,g.scope||e,[g.handler||g.fn,b],!0),defaultEventAction:void 0!==g.defaultEventAction?g.defaultEventAction:b.defaultEventAction}))},this)},handleEvent:function(a,b,c,d){return d.lastKeyEvent=b,c.call(this,b)},destroy:function(a){this.destroyKeyMap&&this.map.destroy(a),delete this.map},enable:function(){this.map&&(this.map.enable(),this.disabled=!1)},disable:function(){this.map&&this.map.disable(),this.disabled=!0},setDisabled:function(a){this.map.setDisabled(a),this.disabled=a},useKeyDown:Box.browser.is.WebKit?parseInt(navigator.userAgent.match(/AppleWebKit\/(\d+)/)[1],10)>=525:!(Box.browser.is.Gecko&&!window||Box.browser.is.Opera),getKeyEvent:function(a,b){return a||this.useKeyDown&&!b?"keydown":b||this.eventName}});
Box.define("Box.util.LruCache",{extend:Box.util.HashMap,maxSize:null,constructor:function(a){Box.apply(this,a),this.callParent([a])},add:function(a,b){var c,d=this,e=d.findKey(b);return e?(d.unlinkEntry(c=d.map[e]),c.prev=d.last,c.next=null):c={prev:d.last,next:null,key:a,value:b},d.last?d.last.next=c:d.first=c,d.last=c,d.callParent([a,c]),d.prune(),b},insertBefore:function(a,b,c){var d,e,f=this;return(c=this.map[this.findKey(c)])?(d=f.findKey(b),d?f.unlinkEntry(e=f.map[d]):e={prev:c.prev,next:c,key:a,value:b},c.prev?e.prev.next=e:f.first=e,e.next=c,c.prev=e,f.prune(),b):f.add(a,b)},get:function(a){var b=this.map[a];return b?(b.next&&this.moveToEnd(b),b.value):void 0},removeAtKey:function(a){return this.unlinkEntry(this.map[a]),this.callParent(arguments)},clear:function(){return this.first=this.last=null,this.callParent(arguments)},unlinkEntry:function(a){a&&(a.next?a.next.prev=a.prev:this.last=a.prev,a.prev?a.prev.next=a.next:this.first=a.next,a.prev=a.next=null)},moveToEnd:function(a){this.unlinkEntry(a),(a.prev=this.last)?this.last.next=a:this.first=a,this.last=a},getArray:function(a){for(var b=[],c=this.first;c;)b.push(a?c.key:c.value),c=c.next;return b},each:function(a,b,c){var d=this,e=c?d.last:d.first,f=d.length;for(b=b||d;e&&a.call(b,e.key,e.value,f)!==!1;)e=c?e.prev:e.next;return d},findKey:function(a){var b,c=this.map;for(b in c)if(c.hasOwnProperty(b)&&c[b].value===a)return b;return void 0},clone:function(){var a,b=new this.self(this.initialConfig),c=this.map;b.suspendEvents();for(a in c)c.hasOwnProperty(a)&&b.add(a,c[a].value);return b.resumeEvents(),b},prune:function(){var a=this,b=a.maxSize?a.length-a.maxSize:0;if(b>0)for(;a.first&&b;b--)a.removeAtKey(a.first.key)}});
Box.define("Box.util.ImageLazyLoad",{mixins:{event:Box.util.Event},container:document,imageFlag:"lazy-src",constructor:function(a){Box.apply(this,a),this.mixins.event.constructor.call(this,a)}});
Box.define("Box.tpl.Base",{requires:[Box.dom.Element,Box.util.Format],mixins:{event:Box.util.Event},uses:["Box.dom.Helper"],isTemplate:!0,scope:null,compiled:!1,disableFormats:!1,html:Box.emptyString,re:/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,constructor:function(a){var b,c=arguments,d=c.length,e=[],f=0;if(d>1){for(;d>f;f++)b=c[f],"object"==typeof b?Box.apply(this,b):e.push(b);this.html=e.join("")}else Box.isArray(a)||Box.isString(a)?this.html=Box.Array.toArray(a).join(""):(Box.isArray(a.html)&&(a.html=a.html.join("")),Box.apply(this,a));this.mixins.event.constructor.call(this,a),this.scope=this.scope||this,this.compiled&&this.compile()},apply:function(a){function b(b,d,g,h){return g&&c?(h=h?[a[d]].concat(Box.functionFactory("return ["+h+"]")()):[a[d]],"this."==g.substr(0,5)?f[g.substr(5)].apply(f,h):e[g].apply(e,h)):void 0!==a[d]?a[d]:Box.emptyString}var c=this.disableFormats!==!0,d=this.compiled,e=Box.util.Format,f=this.scope;if(d)return d(a).join("");var g=this.html.replace(this.re,b);return g},applyTemplate:function(){return this.apply.apply(this,arguments)},applyOther:function(a,b){var c=this.compiled;return c?b.push.apply(b,c(a)):b.push(this.apply(a)),b},compileARe:/\\/g,compileBRe:/(\r\n|\n)/g,compileCRe:/'/g,compile:function(){function compileFn(a,b,c,d){return c&&useFormat?(d=d?","+d:"",c="this."!=c.substr(0,5)?"fm."+c+"(":"tpl."+c.substr(5)+"("):(d="",c="(values['"+b+"'] == undefined ? '' : "),"',"+c+"values['"+b+"']"+d+") ,'"}var me=this,fm=Box.util.Format,useFormat=this.disableFormats!==!0,tpl=this.scope,body,bodyReturn;return this.html=bodyReturn=this.html.replace(this.compileARe,"\\\\").replace(this.compileBRe,"\\n").replace(this.compileCRe,"\\").replace(this.re,compileFn),eval("this.compiled = function (values) { return ['"+bodyReturn+"']; }"),this},prepend:function(a,b,c){return this.doInsert("afterBegin",a,b,c)},before:function(a,b,c){return this.doInsert("beforeBegin",a,b,c)},after:function(a,b,c){return this.doInsert("afterEnd",a,b,c)},append:function(a,b,c){return this.doInsert("beforeEnd",a,b,c)},doInsert:function(a,b,c,d){var e=Box.dom.Helper.insertHtml(a,Box.getDom(b),this.apply(c));return d?Box.get(e):e},overwrite:function(a,b,c){var d=Box.dom.Helper.overwrite(Box.getDom(a),this.apply(b));return c?Box.get(d):d}});
Box.define("Box.tpl.TemplateParser",{useFormat:!1,definitions:!1,constructor:function(a){Box.apply(this,a)},doTpl:Box.emptyFn,parse:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this,o=a.length,p={elseif:"elif"},q=n.topRe,r=n.actionsRe;for(n.level=0,n.stack=c=[],b=0;o>b;b=k){if(q.lastIndex=b,e=q.exec(a),!e){n.doText(a.substring(b,o));break}if(j=e.index,k=q.lastIndex,j>b&&n.doText(a.substring(b,j)),e[1])k=a.indexOf("%}",j+2),n.doEval(a.substring(j+2,k)),k+=2;else if(e[2])k=a.indexOf("]}",j+2),n.doExpr(a.substring(j+2,k)),k+=2;else if(e[3])n.doTag(e[3]);else if(e[4]){for(l=null;null!==(i=r.exec(e[4]));)d=i[2]||i[3],d&&(d=Box.String.htmlDecode(d),f=i[1],f=p[f]||f,l=l||{},g=l[f],"string"==typeof g?l[f]=[g,d]:g?l[f].push(d):l[f]=d);l?l["if"]?(n.doIf(l["if"],l),c.push({type:"if"})):l["switch"]?(n.doSwitch(l["switch"],l),c.push({type:"switch"})):l["case"]?n.doCase(l["case"],l):l.elif?n.doElseIf(l.elif,l):l["for"]?(++n.level,(m=n.propRe.exec(e[4]))&&(l.propName=m[1]||m[2]),n.doFor(l["for"],l),c.push({type:"for",actions:l})):l.foreach?(++n.level,(m=n.propRe.exec(e[4]))&&(l.propName=m[1]||m[2]),n.doForEach(l.foreach,l),c.push({type:"foreach",actions:l})):l.exec&&(n.doExec(l.exec,l),c.push({type:"exec",actions:l})):n.elseRe.test(e[4])?n.doElse():n.defaultRe.test(e[4])?n.doDefault():(n.doTpl(),c.push({type:"tpl"}))}else 5===e[0].length?c.push({type:"tpl"}):(h=c.pop(),n.doEnd(h.type,h.actions),("for"==h.type||"foreach"==h.type)&&--n.level)}},topRe:/(?:(\{\%)|(\{\[)|\{([^{}]+)\})|(?:<tpl([^>]*)\>)|(?:<\/tpl>)/g,actionsRe:/\s*(elif|elseif|if|for|foreach|exec|switch|case|eval|between)\s*\=\s*(?:(?:"([^"]*)")|(?:'([^']*)'))\s*/g,propRe:/prop=(?:(?:"([^"]*)")|(?:'([^']*)'))/,defaultRe:/^\s*default\s*$/,elseRe:/^\s*else\s*$/});
Box.define("Box.tpl.TemplateCompiler",{extend:Box.tpl.TemplateParser,useEval:!0,useIndex:!0,propNameRe:/^[\w\d\$]*$/,definitions:[],fnArgs:"out, values, parent, xindex, xcount, xkey",constructor:function(){this.callParent(arguments),this.callFn=".call(this,"+this.fnArgs+")"},compile:function(a){var b=this,c=b.generate(a),d=b.useEval?b.evalTpl(c):new Function("Box",c)(Box);return d},generate:function(a){var b,c=this,d="var fm=Box.util.Format,ts=Object.prototype.toString;";return c.maxLevel=0,c.body=["var c0=values, a0="+c.createArrayTest(0)+", p0=parent, n0=xcount, i0=xindex, k0, v;\n"],c.definitions?"string"==typeof c.definitions?c.definitions=[c.definitions,d]:c.definitions.push(d):c.definitions=[d],c.switches=[],c.parse(a),c.definitions.push((c.useEval?"$=":"return")+" function ("+c.fnArgs+") {",c.body.join(""),"}"),b=c.definitions.join("\n"),c.definitions.length=c.body.length=c.switches.length=0,delete c.definitions,delete c.body,delete c.switches,b},doText:function(a){var b=this,c=b.body;a=a.replace(b.aposRe,"\\'").replace(b.newLineRe,"\\n"),b.useIndex?c.push("out[out.length]='",a,"'\n"):c.push("out.push('",a,"')\n")},doExpr:function(a){var b=this.body;b.push("if ((v="+a+") != null) out"),b.push(this.useIndex?"[out.length]=v+''\n":".push(v+'')\n")},doTag:function(a){var b=this.parseTag(a);b?this.doExpr(b):this.doText("{"+a+"}")},doElse:function(){this.body.push("} else {\n")},doEval:function(a){this.body.push(a,"\n")},doIf:function(a,b){var c=this;"."===a?c.body.push("if (values) {\n"):c.propNameRe.test(a)?c.body.push("if (",c.parseTag(a),") {\n"):c.body.push("if (",c.addFn(a),c.callFn,") {\n"),b.exec&&c.doExec(b.exec)},doElseIf:function(a,b){var c=this;"."===a?c.body.push("else if (values) {\n"):c.propNameRe.test(a)?c.body.push("} else if (",c.parseTag(a),") {\n"):c.body.push("} else if (",c.addFn(a),c.callFn,") {\n"),b.exec&&c.doExec(b.exec)},doSwitch:function(a){var b=this;"."===a?b.body.push("switch (values) {\n"):b.propNameRe.test(a)?b.body.push("switch (",b.parseTag(a),") {\n"):b.body.push("switch (",b.addFn(a),b.callFn,") {\n"),b.switches.push(0)},doCase:function(a){var b,c,d=this,e=Box.isArray(a)?a:[a],f=d.switches.length-1;for(d.switches[f]?d.body.push("break;\n"):d.switches[f]++,c=0,f=e.length;f>c;++c)b=d.intRe.exec(e[c]),e[c]=b?b[1]:"'"+e[c].replace(d.aposRe,"\\'")+"'";d.body.push("case ",e.join(": case "),":\n")},doDefault:function(){var a=this,b=a.switches.length-1;a.switches[b]?a.body.push("break;\n"):a.switches[b]++,a.body.push("default:\n")},doEnd:function(a,b){var c=this,d=c.level-1;"for"==a||"foreach"==a?(b.exec&&c.doExec(b.exec),c.body.push("}\n"),c.body.push("parent=p",d,";values=r",d+1,";xcount=n"+d+";xindex=i",d,"+1;xkey=k",d,";\n")):("if"==a||"switch"==a)&&c.body.push("}\n")},doFor:function(a,b){var c,d,e=this,f=e.level,g=f-1;c="."===a?"values":e.propNameRe.test(a)?e.parseTag(a):e.addFn(a)+e.callFn,e.maxLevel<f&&(e.maxLevel=f,e.body.push("var ")),d="."==a?"c"+f:"a"+g+"?c"+g+"[i"+g+"]:c"+g,e.body.push("i",f,"=0,n",f,"=0,c",f,"=",c,",a",f,"=",e.createArrayTest(f),",r",f,"=values,p",f,",k",f,";\n","p",f,"=parent=",d,"\n","if (c",f,"){if(a",f,"){n",f,"=c",f,".length;}else if (c",f,".isMixedCollection){c",f,"=c",f,".items;n",f,"=c",f,".length;}else if(c",f,".isStore){c",f,"=c",f,".data.items;n",f,"=c",f,".length;}else{c",f,"=[c",f,"];n",f,"=1;}}\n","for (xcount=n",f,";i",f,"<n"+f+";++i",f,"){\n","values=c",f,"[i",f,"]"),b.propName&&e.body.push(".",b.propName),e.body.push("\n","xindex=i",f,"+1\n"),b.between&&e.body.push('if(xindex>1){ out.push("',b.between,'"); } \n')},doForEach:function(a,b){var c,d,e=this,f=e.level,g=f-1;c="."===a?"values":e.propNameRe.test(a)?e.parseTag(a):e.addFn(a)+e.callFn,e.maxLevel<f&&(e.maxLevel=f,e.body.push("var ")),d="."==a?"c"+f:"a"+g+"?c"+g+"[i"+g+"]:c"+g,e.body.push("i",f,"=-1,n",f,"=0,c",f,"=",c,",a",f,"=",e.createArrayTest(f),",r",f,"=values,p",f,",k",f,";\n","p",f,"=parent=",d,"\n","for(k",f," in c",f,"){\n","xindex=++i",f,"+1;\n","xkey=k",f,";\n","values=c",f,"[k",f,"];"),b.propName&&e.body.push(".",b.propName),b.between&&e.body.push('if(xindex>1){ out.push("',b.between,'"); } \n')},createArrayTest:"isArray"in Array?function(a){return"Array.isArray(c"+a+")"}:function(a){return"ts.call(c"+a+')==="[object Array]"'},doExec:function(a){var b=this,c="f"+b.definitions.length;b.definitions.push("function "+c+"("+b.fnArgs+") {"," try { with(values) {","  "+a," }} catch(e) {",'   Box.log("XTemplate Error: " + e.message);',"}","}"),b.body.push(c+b.callFn+"\n")},addFn:function(a){var b=this,c="f"+b.definitions.length;return"."===a?b.definitions.push("function "+c+"("+b.fnArgs+") {"," return values","}"):".."===a?b.definitions.push("function "+c+"("+b.fnArgs+") {"," return parent","}"):b.definitions.push("function "+c+"("+b.fnArgs+") {"," try { with(values) {","  return("+a+")"," }} catch(e) {",'   Box.log("XTemplate Error: " + e.message);',"}","}"),c},parseTag:function(a){var b,c,d,e,f,g=this,h=g.tagRe.exec(a);return h?(b=h[1],c=h[2],d=h[3],e=h[4],"."==b?(g.validTypes||(g.definitions.push("var validTypes={string:1,number:1,boolean:1};"),g.validTypes=!0),f='validTypes[typeof values] || ts.call(values) === "[object Date]" ? values : ""'):f="#"==b?"xindex":"$"==b?"xkey":"parent."==b.substr(0,7)?b:isNaN(b)&&-1==b.indexOf("-")&&-1!=b.indexOf(".")?"values."+b:"values['"+b+"']",e&&(f="("+f+e+")"),c&&g.useFormat?(d=d?","+d:"","this."!=c.substr(0,5)?c="fm."+c+"(":c+="(",c+f+d+")"):f):null},evalTpl:function($){return eval($),$},newLineRe:/\r\n|\r|\n/g,aposRe:/[']/g,intRe:/^\s*(\d+)\s*$/,tagRe:/^([\w-\.\#\$]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?(\s?[\+\-\*\/]\s?[\d\.\+\-\*\/\(\)]+)?$/});
Box.define("Box.tpl.Template",{extend:Box.tpl.Base,requires:[Box.tpl.TemplateCompiler],scope:null,compiled:!1,disableFormats:!1,definitions:!1,html:Box.emptyString,emptyObj:{},apply:function(a,b){return this.applyOther(a,[],b).join("")},applyOther:function(a,b,c){var d;this.fn||(d=new Box.tpl.TemplateCompiler({useFormat:this.disableFormats!==!0,definitions:this.definitions}),this.fn=d.compile(this.html));try{this.fn.call(this.scope,b,a,c||this.emptyObj,1,1)}catch(e){Box.Error({className:"Box.XTemplate",methodName:"applyOther",error:e.message})}return b},compile:function(){return this}});
Box.define("Box.ComponentTplCompile",{requires:[Box.tpl.Template],singleton:!0,tpl:function(a,b){return new Box.tpl.Template({html:a,compile:!0,disableFormats:!1,scope:b})},ejs:function(a){return Box.isDefined(ejs)||Box.Error({className:"Box.ComponentTplCompile",methodName:"ejs",error:"you must load ejs lib"}),function(b){return ejs.render(a,b)}},handlebars:function(a,b){return Box.isDefined(Handlebars)||Box.Error({className:"Box.ComponentTplCompile",methodName:"handlebars",error:"you must load handlebarsjs lib"}),function(c){var d={};for(var e in Handlebars.helpers)d[e]=Handlebars.helpers[e];for(var e in b)d[e]=b[e];return Handlebars.compile(a)(c,{helpers:d})}}});
Box.define("Box.ComponentTplFactory",{statics:{TEMPLATE_SCOPE_END_PREFIX:"TemplateHelpers"},requires:[Box.util.JSON,Box.util.HashMap,Box.dom.Helper,Box.ComponentTplCompile],singleton:!0,pools:{},register:function(a,b){var c=[];Box.Object.each(b,function(b,d){d.name=b,this.push2Pools(a,[d]),d.id&&(d.content=this.parseElementTemplateContent(d.id)),d.content?this.setContent(a,d.name,d.content):Box.isEmpty(d.path)||this.isLoaded(a,d.name)||c.push(d)},this),this.proxy(a,c)},parseElementTemplateContent:function(a){var b=Box.get("#"+a).hide();return Box.isEmpty(b)?Box.dom.Helper.parse({tag:"div"}):b.html()},push2Pools:function(a,b){var c,d=a.$className;(c=this.pools[d])||(c=this.pools[d]=new Box.util.HashMap({getKey:function(a){return a.name}})),Box.Array.forEach(b,function(a){Box.isEmpty(c.get(a.name))&&c.push(a.name,a)},this)},proxy:function(a,b,c,d){if(b=Box.isArray(b)?b:[b],!Box.isEmpty(b))if(Box.isEmpty(Box.TEMPLATE_SERVER_URL))Box.Array.forEach(b,function(b){this.setContent(a,b.name,Box.requireSync("text!"+b.path))},this);else{var e={async:!1,type:Box.TEMPLATE_SERVER_METHOD||"GET",url:Box.TEMPLATE_SERVER_URL},f=this;e.data=Box.apply({templates:Box.util.JSON.encode(b)},c||{});var g=function(b){Box.isFunction(d)&&(b=d.call(a,b)),Box.Object.each(b,function(b,c){this.setContent(a,b,c)},f)};Box.DOM_QUERY.ajax(e).done(g)}},compile:function(a,b,c){var d,e=this.statics().TEMPLATE_SCOPE_END_PREFIX,f=Box.ComponentTplCompile[Box.TEMPLATE_TYPE];if(Box.isString(c)||Box.isArray(c)){var g=a[b+e]||a;c=Box.isArray(c)?c.join(""):c,d=f(c,g)}else Box.isFunction(c)&&(d=c);Box.isEmpty(d)&&(d=function(){return Box.dom.Helper.parse({tag:"div"})}),a.__$setCompileTemplate(b,d)},setContent:function(a,b,c){var d=this.get(a,b);return this.compile(a,b,c),d.content=c},isLoaded:function(a,b){var c=this.get(a,b);return!Box.isEmpty(c.content)},get:function(a,b){var c=this.pools[a.$className];return Box.isEmpty(c)?null:c.get(b)}});
Box.define("Box.Component",{statics:{ON_RENDER_ATTR_PREFIX:"_onChangeFor",GENERATE_ID_PREFIX:"HY_ELEMENT_",GENERATE_INDEX:+new Date,getGenerateID:function(){return this.GENERATE_ID_PREFIX+ ++this.GENERATE_INDEX}},extend:Box.Base,mixins:{event:Box.util.Event},requires:[Box.dom.Helper,Box.dom.Element,Box.tpl.Base,Box.tpl.Template,Box.ComponentTplFactory],elements:{},events:{},delegates:{},templates:{},listeners:{},target:null,renderTo:null,autoRender:!0,isComponent:!0,setElementId:function(a){var b=this.statics(),c=this;Box.isEmpty(a)||(a.jquery?a.each(function(){c.setElementId(this)}):Box.isArray(a)?Box.Array.forEach(a,function(a){this.setElementId(a)},this):Box.isElement(a)&&Box.isEmpty(a.id)&&(a.id=b.getGenerateID()))},constructor:function(a){var b=this.statics();return Box.isEmpty(a)&&(a={}),Box.apply(this,a),this.initialConfig=a,this.__$name=b.getGenerateID(),this.mixins.event.constructor.call(this,a),this.setting(),this.initTemplates(),this.autoRender&&this.render(),this},setting:Box.emptyFn,beforeRender:function(){var a=this.target;this.el=this.el||{},a?this.el.target=Box.get(a):this.tpl.main&&(this.el.target=this.applyTemplate("main")),Box.isEmpty(this.el.target)&&Box.Error("the el.target is undefined"),this.setElementId(this.el.target)},render:function(a){return this.rendered?(this.destroy(!1),this.destroyed=!1,this.rendered=!1,void this.render()):void(this.rendered||this.trigger("beforerender",this)===!1||(this.beforeRender(),this.onRender(a),this.afterRender()))},onRender:function(a){a=Box.get(a||this.renderTo),a&&a.length>0&&(Box.isFunction(this.renderToFn)?this.renderToFn(this.el.target,a):a.append(this.el.target)),this.applyElements(),this.initEvents(),this.initDelegates(),this.initAttrsForRender(),this.trigger("render",this)},afterRender:function(){this.trigger("afterrender",this),this.setup(),this.rendered=!0},setup:Box.emptyFn,renderToFn:null,initAttrsForRender:function(){var a=this,b=this.statics();Box.Object.each(this.attrs,function(c){var d=b.ON_RENDER_ATTR_PREFIX+Box.String.firstUpperCase(c);if(this[d]){var e=this.get(c);Box.isEmpty(e)||this[d](e,void 0,c),function(b){a.on("change:"+c,function(a,c,d){this[b](a,c,d)})}(d)}},this)},initTemplates:function(){var a,b=this.templates;"string"==typeof b?b={main:{name:"main",path:b}}:Box.isObject(b)&&(b=Box.apply({},this.templates,{})),Box.Object.each(b,function(c,d){Box.isString(d)?b[c]=Box.String.has(d,".")?{name:c,path:d}:{name:c,id:d}:(Box.isArray(d)||Box.isFunction(d))&&(b[c]={name:c,content:d}),a="apply"+Box.String.firstUpperCase(c)+"Template",this[a]=function(a,b){return this.applyTemplate(c,a,b)}},this),this.tpl={},Box.ComponentTplFactory.register(this,b)},__$setCompileTemplate:function(a,b){return this.tpl[a]=b},applyTemplate:function(a,b,c){var d=this.tpl[a];"main"==a&&(b=Box.apply({},this.getMainTplData()));var e=d.isTemplate?d.apply(b):d.call(this,b);return c?e:Box.get(e)},applyTemplateTo:function(a,b,c,d,e){var f=this.tpl[a];if(!f.isTemplate){var g=f.call(this,b),h=e?g:Box.get(g);return"overwrite"==d&&(d="html"),c[d](g),h}return f[d](c,b,e)},getMainTplData:function(){return{}},applyElements:function(a){Box.Object.each(a||this.elements||{},function(a,b){this.element(a,b,!0)},this)},element:function(a,b,c){var d,e=-1,f=this.el;if(!Box.isEmpty(b)){Box.isString(b)?(e=b.indexOf("@"),d=0>e?f.target.find(b):f[b.substr(0,e)].find(b.substr(e+1))):d=b.jquery?b:Box.get(b),this.__event_cache=this.__event_cache||{};var g=this.__event_cache[a]||{};return f[a]=Box.isEmpty(f[a])?d:f[a].add(d),c||Box.Object.each(g,function(a,b){Box.Array.forEach(b||[],function(b){this.mon(d,a,b)},this)},this),d}},__$eventReg:/([a-z]+)\s+([a-zA-Z0-9_-]+)(\s+\{([^\{\}]+)\})?/,initEvents:function(a){a=a||Box.apply({},this.events),Box.isEmpty(a)||Box.Object.each(a,function(a,b){var c,d=a.match(this.__$eventReg),a=d[2],e=d[1],f=d[4];if(Box.isEmpty(f)||this.applyElements(function(){var b={};return b[a]=f,b}()),!Box.isEmpty(c=this.el[a])){var g=this.__event_cache[a]=this.__event_cache[a]||{};g[e]=g[e]||[],g[e].push(b),this.mon(c,e,b)}},this)},mon:function(a,b,c,d){var e=this;return Box.isString(c)&&(c=this[c]),Box.isFunction(c)&&!Box.isEmpty(a)?(Box.isString(a)&&(a=this.el[a]),a.bind(b||Box.EventType.CLICK,function(a){return c.call(d||e,a,Box.get(this),e)}),this):void 0},unmon:function(a,b){return a=Box.isString(a)?this.el[a]:a,Box.isEmpty(a)?void 0:(Box.isEmpty(b)?a.unbind():a.unbind(b),this)},initDelegates:function(){var a=Box.apply({},this.delegates);Box.Object.each(a,function(a,b){this.don(a,b)},this)},__$delegateReg:/([a-z]+)\s+\{([^\{\}]+)\}/,don:function(a,b,c){var d=this;if(b=this[b],Box.isFunction(b)){var e,f=a.match(this.__$delegateReg),g=Box.EventType.CLICK;Box.isEmpty(f)?e=a:(g=f[1],e=f[2]),this.el.target.delegate(e,g,function(a){var f=Box.get(a.target);return f.is(e)||(f=f.closest(e).eq(0)),b.call(c||d,a,f,d)===!1?(a.stopPropagation(),!1):!0})}},undon:function(a,b){this.el.target.undelegate(a,b||Box.EventType.CLICK)},beforeDestroy:function(){Box.Object.each(this.__event_cache,function(a){var b=this.el[a];b&&b.jquery&&b.unbind(),delete this.__event_cache[a]},this),this.el.target.undelegate(),Box.Object.each(this.tpl,function(a){delete this.tpl[a]},this),this.tpl=null},destroy:function(a){this.destroyed||this.trigger("beforedestroy",this)===!1||(this.beforeDestroy(),this.onDestroy(),this.afterDestroy(a))},onDestroy:function(){Box.Object.each(this.el||{},function(a,b){"target"!=a&&(b.jquery?b.remove():Box.isArray(b)?Box.Array.forEach(b,function(a){a.remove()},this):Box.isObject(b)&&Box.Object.each(b,function(a,b){b.remove()},this),delete this.el[a])},this),this.trigger("destroy",this)},afterDestroy:function(a){if(this.trigger("afterdestroy",this),this.rendered&&this.el.target&&!this.target&&(this.el.target.remove(),this.el.target=null),this.off(),this.destroyed=!0,!a)for(var b in this)this.hasOwnProperty(b)&&delete this[b]}});
Box.define("Box.ui.FileUpload",{extend:"Box.Component"});
Box.define("Box.ui.Pagination",{extend:"Box.Component"});
Box.define("Box.ui.Photos",{extend:"Box.Component"});
Box.define("Box.ui.Slider",{extend:"Box.Component"});
Box.define("Box.ui.Validator",{extend:"Box.Component",constructor:function(){}});
Box.define("Box.app.History",{mixins:{event:Box.util.Event},singleton:!0,routeStripper:/^[#\/]|\s+$/g,rootStripper:/^\/+|\/+$/g,pathStripper:/#.*$/,started:!1,handlers:[],constructor:function(){"undefined"!=typeof window&&(this.location=window.location,this.history=window.history),this.mixins.event.constructor.call(this)},interval:50,atRoot:function(){var a=this.location.pathname.replace(/[^\/]$/,"$&/");return a===this.root&&!this.getSearch()},getSearch:function(){var a=this.location.href.replace(/#.*/,"").match(/\?.+/);return a?a[0]:""},getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getPath:function(){var a=decodeURI(this.location.pathname+this.getSearch()),b=this.root.slice(0,-1);return a.indexOf(b)||(a=a.slice(b.length)),"/"===a.charAt(0)?a.slice(1):a},getFragment:function(a){return null==a&&(a=this._hasPushState||!this._wantsHashChange?this.getPath():this.getHash()),a.replace(this.routeStripper,"")},start:function(a){if(this.started&&Box.Error("Box.app.Router has already been started"),this.started=!0,this.options=Box.apply({root:"/"},this.options,a),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState),this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(this.rootStripper,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var b=this.root.slice(0,-1)||"/";return this.location.replace(b+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!(this._hasHashChange||!this._wantsHashChange||this._wantsPushState&&this._hasPushState)){var c=document.createElement("iframe");c.src="javascript:0",c.style.display="none",c.tabIndex=-1;var d=document.body;this.iframe=d.insertBefore(c,d.firstChild).contentWindow,this.iframe.document.open().close(),this.iframe.location.hash="#"+this.fragment}var e=window.addEventListener||function(a,b){return attachEvent("on"+a,b)},f=Box.Function.bind(this.checkUrl,this);return this._hasPushState?e("popstate",f,!1):this._wantsHashChange&&this._hasHashChange&&!this.iframe?e("hashchange",f,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(f,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var a=window.removeEventListener||function(a,b){return detachEvent("on"+a,b)};this._hasPushState?a("popstate",this.checkUrl,!1):this._wantsHashChange&&this._hasHashChange&&!this.iframe&&a("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe.frameElement),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),this.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();return a===this.fragment&&this.iframe&&(a=this.getHash(this.iframe)),a===this.fragment?!1:(this.iframe&&this.navigate(a),void this.loadUrl())},loadUrl:function(a){a=this.fragment=this.getFragment(a),Box.Array.each(this.handlers,function(b){return b.route.test(a)?(b.callback(a),!1):void 0})},navigate:function(a,b){if(!this.started)return!1;b&&b!==!0||(b={trigger:!!b}),a=this.getFragment(a||"");var c=this.root;(""===a||"?"===a.charAt(0))&&(c=c.slice(0,-1)||"/");var d=c+a;if(a=decodeURI(a.replace(this.pathStripper,"")),this.fragment!==a){if(this.fragment=a,this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,d);else{if(!this._wantsHashChange)return this.location.assign(d);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getHash(this.iframe)&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}});
Box.define("Box.app.Router",{mixins:{event:Box.util.Event},requires:[Box.app.History],scope:null,routes:{},optionalParam:/\((.*?)\)/g,namedParam:/(\(\?)?:\w+/g,splatParam:/\*\w+/g,escapeRegExp:/[\-{}\[\]+?.,\\\^$|#\s]/g,constructor:function(a){Box.apply(this,a),this.scope=this.scope||this,this.mixins.event.constructor.call(this),this.set(this.routes),Box.app.History.started||Box.app.History.start()},set:function(a,b){if(Box.isObject(a))return Box.Object.each(a,function(a,b){this.set(a,b)},this),this;Box.isRegExp(a)||(a=this._routeToRegExp(a)),Box.isFunction(b)||(b=this.scope[b]);var c=this;return Box.app.History.route(a,function(d){var e=c._extractParameters(a,d);c.execute(b,e)!==!1&&c.trigger("route",e)}),this},navigate:function(a,b){return Box.app.History.navigate(a,b),this},execute:function(a,b){a&&a.apply(this.scope,b)},_routeToRegExp:function(a){return a=a.replace(this.escapeRegExp,"\\$&").replace(this.optionalParam,"(?:$1)?").replace(this.namedParam,function(a,b){return b?a:"([^/?]+)"}).replace(this.splatParam,"([^?]*?)"),new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(a,b){var c=a.exec(b).slice(1);return Box.Array.map(c,function(a,b){return b===c.length-1?a||null:a?decodeURIComponent(a):null})}});
Box.define("Box.app.Store",{extend:Box.util.HashMap,singleton:!0,get:function(a,b){if(1==arguments.length)return this.callParent(arguments);var c=this.map[a];return Box.isEmpty(c)?void 0:c[b]},set:function(a,b,c){return arguments.length<3?this.callParent(arguments):(this.map[a]=this.map[a]||{},this.map[a][b]=c)}});
Box.define("Box.app.Interface",{requires:[],constructor:function(){for(var a in this.interfaces){var b=this.interfaces[a];b.name=a,this.registerInterface(b)}},interfaces:{},send:function(a,b,c,d,e){var f,g,h={};h.headers={},d=d||[];for(var i=0;i<d.length;i++)g=d[i],h.headers[g]=this.parseHeaders[g]();return h.url=a,h.type="POST"|e,h.data=(Box.isFunction(b)?b():b)||{},f=$.ajax(h),f.done(c||Box.emptyFn)},registerInterface:function(a){var b=this;this[a.name]=function(c,d){return 1==arguments.length&&Box.isFunction(c)&&(d=c,c=null),Box.isFunction(a.url)&&(a.url=a.url(c)),b.send(a.url,c,a.callback?function(b){a.callback(b),d(b)}:d,a.headers,a.type)}}});
Box.define("Box.app.View",{requires:[Box.tpl.Template],attrs:{html:null,data:null,change:!1,scope:null},constructor:function(){this.callParent(arguments),this.tpl=Box.create("Box.tpl.Template",{html:this.get("html"),disableFormats:!1,scope:this.get("scope")})},apply:function(a){Box.isEmpty(a)?a=this.get("data"):this.set("data",a,{silent:!0});var b=Box.query(this.tpl.apply(a));return Box.isEmpty(this.dom)||this.dom.replaceWith(b),this.dom=b},_onChangeData:function(a){this.get("change")&&this.apply(a)}});
Box.define("Box.app.Viewport",{requires:[Box.app.History,Box.app.Router],extend:Box.Component,target:document.body,routes:{},setRoute:function(a,b){this.router.set(a,b)},navigate:function(a,b){return Box.app.History.navigate(a,b),this},afterRender:function(){this.callParent(arguments),this.router=Box.create("Box.app.Router",{scope:this,routes:this.routes})}});
Box.define("Box.app.Application",{singleton:!0,name:"Box",baseFolder:"app",paths:{},resources:[],templateType:"tpl",templateServerUrl:!1,templateServerMethod:"POST",launch:null,launchProperties:{},create:function(a){var b=this;this.created&&Box.Error("Box.app.Application is already created."),Box.apply(this,a),this.setTemplateConfig(),this.proxy=new Box.util.ListenerProxy,Box.getDoc().ready(function(){b.importResources(),b.proxy.after("imports",b.resources.length,function(){b.afterImportResources(),b.paths[b.name]=b.baseFolder,b.setPaths(b.paths),b.__$domReady=!0,b.launch&&b.doLaunch()})}),this.created=!0},setTemplateConfig:function(){this.templateType&&(Box.TEMPLATE_TYPE=this.templateType),this.templateServerUrl&&(Box.TEMPLATE_SERVER_URL=this.templateServerUrl),this.templateServerMethod&&(Box.TEMPLATE_SERVER_METHOD=this.templateServerMethod)},setPaths:function(a,b){var c={};Box.isString(a)?c[a]=b:c=a,Box.Loader.setPath(c)},domain:function(a){this.launch=a,this.__$domReady&&this.doLaunch()},doLaunch:function(){var a,b=this.launch;Box.isFunction(b)?a=b.call(this):Box.isObject(b)?a=Box.create("Box.app.Viewport",b):Box.isString(b)&&(a=Box.create(b,this.launchProperties)),Box.app.Application.viewport=a},importResources:function(){var a=this;this.beforeImportResources(this.resources),Box.Array.forEach(this.resources,function(b){Box.Loader.loadScriptFile(b,function(){a.proxy.emit("imports")},function(){a.proxy.emit("imports")})},this)},beforeImportResources:Box.emptyFn,afterImportResources:Box.emptyFn});